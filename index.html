<!doctype html>
<html lang="bn">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Saikat Tech Hub | Store + Services</title>
  <meta name="description" content="Social Media Services + Products. WhatsApp order. Admin panel (logo/cover/products/services/categories/payments/contact)." />

  <!-- Multi-font (Premium look) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800&family=Playfair+Display:wght@600;700;800&family=Space+Grotesk:wght@500;700&family=Hind+Siliguri:wght@400;600;700&display=swap" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">

  <style>
    :root{
      --bg:#070b18;
      --text:#f8fafc;
      --muted:#a8b3d6;
      --line:rgba(255,255,255,.12);
      --panel:rgba(255,255,255,.06);
      --panel2:rgba(255,255,255,.09);
      --brand:#3b82f6;
      --pink:#ec4899;
      --green:#22c55e;
      --warn:#f59e0b;
      --radius:22px;
      --shadow: 0 28px 85px rgba(0,0,0,.56);
      --shadow2: 0 16px 44px rgba(0,0,0,.42);
      --max: 1180px;

      --font-body: "Poppins", system-ui, -apple-system, Segoe UI, Roboto, Arial;
      --font-title: "Playfair Display", serif;
      --font-ui: "Space Grotesk", system-ui, -apple-system, Segoe UI, Roboto, Arial;
      --font-bn: "Hind Siliguri", system-ui, -apple-system, Segoe UI, Roboto, Arial;
    }

    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      margin:0;
      font-family:var(--font-body);
      color:var(--text);
      background:
        radial-gradient(900px 650px at 10% -10%, rgba(59,130,246,.35), transparent 60%),
        radial-gradient(900px 650px at 95% 0%, rgba(236,72,153,.26), transparent 60%),
        radial-gradient(900px 650px at 50% 120%, rgba(34,197,94,.18), transparent 60%),
        var(--bg);
      overflow-x:hidden;
    }

    a{color:inherit;text-decoration:none}
    .container{max-width:var(--max);margin:0 auto;padding:18px}
    .muted{color:var(--muted)}
    .bn{font-family:var(--font-bn)}

    /* buttons */
    .btn{
      display:inline-flex;align-items:center;gap:10px;
      border:0;cursor:pointer;
      padding:12px 14px;border-radius:999px;
      font-weight:900;color:#fff;
      box-shadow:var(--shadow2);
      transition:.15s ease;
      white-space:nowrap;
      font-size:14px;
      font-family:var(--font-ui);
      letter-spacing:.2px;
    }
    .btn:hover{transform: translateY(-1px)}
    .btn.primary{background:linear-gradient(135deg,#3b82f6,#2563eb)}
    .btn.pink{background:linear-gradient(135deg,#ec4899,#f472b6)}
    .btn.wa{background:linear-gradient(135deg,#22c55e,#16a34a)}
    .btn.warn{background:linear-gradient(135deg,#f59e0b,#f97316)}
    .btn.ghost{
      background:rgba(255,255,255,.08);
      border:1px solid var(--line);
      box-shadow:none;color:var(--text);
    }
    .btn.small{padding:10px 12px;font-size:13px}

    .chip{
      display:inline-flex;align-items:center;gap:8px;
      padding:8px 12px;border-radius:999px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.06);
      font-weight:800;color:#e5e7eb;
      white-space:nowrap;
      font-size:13px;
      font-family:var(--font-ui);
    }

    /* top bar */
    .topbar{border-bottom:1px solid var(--line);background:rgba(0,0,0,.14);backdrop-filter: blur(10px);}
    .topbar .inner{
      max-width:var(--max);margin:0 auto;padding:10px 18px;
      display:flex;gap:10px;align-items:center;justify-content:space-between;flex-wrap:wrap;
      font-size:13px;color:var(--muted);
      font-family:var(--font-ui);
    }

    /* header */
    header{
      position:sticky;top:0;z-index:60;
      background:rgba(7,11,24,.86);
      backdrop-filter: blur(14px);
      border-bottom:1px solid var(--line);
    }
    .head{
      display:flex;align-items:center;gap:12px;
      padding:14px 0;flex-wrap:wrap;
    }
    .brand{
      display:flex;align-items:center;gap:12px;
      white-space:nowrap;
    }
    .logoBox{
      width:44px;height:44px;border-radius:16px;
      border:1px solid var(--line);
      background:linear-gradient(135deg, rgba(96,165,250,.25), rgba(236,72,153,.18));
      overflow:hidden;
      display:grid;place-items:center;
      box-shadow:0 18px 45px rgba(59,130,246,.18);
    }
    .logoBox img{width:100%;height:100%;object-fit:cover;display:none}
    .logoBox .fallback{
      width:100%;height:100%;
      display:grid;place-items:center;
      background:linear-gradient(135deg, rgba(96,165,250,.95), rgba(236,72,153,.88));
      color:#fff;font-weight:900;
      font-family:var(--font-ui);
    }
    .brandTitle{
      display:flex;flex-direction:column;gap:2px;
      line-height:1.05;
    }
    .brandTitle b{
      font-family:var(--font-title);
      letter-spacing:.2px;
      font-size:18px;
      background:linear-gradient(135deg,#60a5fa,#ec4899);
      -webkit-background-clip:text;color:transparent;
    }
    .brandTitle span{
      font-family:var(--font-ui);
      color:var(--muted);
      font-size:12.5px;
      letter-spacing:.2px;
    }

    nav{margin-left:auto;display:flex;gap:8px;flex-wrap:wrap;align-items:center}
    nav a{
      padding:11px 12px;border-radius:14px;
      font-weight:900;color:var(--muted);font-size:14px;
      font-family:var(--font-ui);
    }
    nav a:hover{background:rgba(255,255,255,.10);color:var(--text)}
    .menu-btn{
      display:none;margin-left:auto;
      border:1px solid var(--line);
      background: rgba(255,255,255,.06);
      color: var(--text);
      border-radius:14px;
      padding:10px 12px;
      cursor:pointer;font-weight:900;
      font-family:var(--font-ui);
    }
    .mnav{display:none;border-top:1px solid var(--line);padding:10px 0 14px}
    .mnav.show{display:block}
    .mnav a{
      display:block;padding:12px 12px;border-radius:14px;
      color:var(--muted);font-weight:900;
      font-family:var(--font-ui);
    }
    .mnav a:hover{background:rgba(255,255,255,.06);color:var(--text)}

    .search{
      flex: 1 1 320px;
      display:flex;gap:10px;align-items:center;
      border:1px solid var(--line);
      background: rgba(255,255,255,.06);
      border-radius: 16px;
      padding:10px 12px;
      max-width: 520px;
      font-family:var(--font-ui);
    }
    .search input{
      width:100%;
      border:0;outline:none;
      background:transparent;
      color:var(--text);
      font-weight:700;
      font-size:14px;
      font-family:var(--font-ui);
    }

    /* cover section (facebook style) */
    .coverWrap{padding:18px 0 10px}
    .coverCard{
      border-radius: calc(var(--radius) + 8px);
      border:1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.04));
      box-shadow: var(--shadow);
      overflow:hidden;
      position:relative;
    }
    .cover{
      height:280px;
      background:
        radial-gradient(900px 280px at 20% 0%, rgba(59,130,246,.24), transparent 65%),
        radial-gradient(900px 280px at 80% 0%, rgba(236,72,153,.20), transparent 65%),
        linear-gradient(135deg, rgba(59,130,246,.14), rgba(236,72,153,.12));
      position:relative;
    }
    .cover::after{
      content:"";
      position:absolute;inset:0;
      background: linear-gradient(180deg, rgba(0,0,0,.05), rgba(0,0,0,.55));
      pointer-events:none;
    }
    .coverImg{
      position:absolute;inset:0;
      background-size:cover;
      background-position:center;
      opacity:1;
    }
    .profileRow{
      position:relative;
      padding:0 18px 18px;
      display:flex;gap:16px;align-items:flex-end;flex-wrap:wrap;
      margin-top:-52px;
    }
    .profileLogo{
      width:104px;height:104px;border-radius:999px;
      border:2px solid rgba(255,255,255,.22);
      background: rgba(255,255,255,.06);
      overflow:hidden;
      box-shadow: var(--shadow2);
      display:grid;place-items:center;
    }
    .profileLogo img{width:100%;height:100%;object-fit:cover;display:none}
    .profileLogo .pfFallback{
      width:100%;height:100%;
      display:grid;place-items:center;
      background:linear-gradient(135deg, rgba(96,165,250,.95), rgba(236,72,153,.88));
      color:#fff;font-weight:900;
      font-family:var(--font-ui);
      font-size:34px;
    }
    .profileText{
      min-width:220px;
      display:flex;flex-direction:column;gap:6px;
      padding-bottom:10px;
    }
    .profileText h1{
      margin:0;
      font-family:var(--font-title);
      font-size:34px;
      letter-spacing:.2px;
      line-height:1.08;
    }
    .profileText .tagline{
      font-family:var(--font-ui);
      color:rgba(248,250,252,.90);
      font-weight:700;
      letter-spacing:.2px;
    }
    .glowText{
      background:linear-gradient(135deg,#60a5fa,#ec4899,#22c55e);
      -webkit-background-clip:text;color:transparent;
      text-shadow: 0 0 25px rgba(96,165,250,.14);
      font-weight:900;
    }
    .profileActions{
      margin-left:auto;
      display:flex;gap:10px;flex-wrap:wrap;
      padding-bottom:10px;
    }

    /* sections */
    .section{padding:14px 0 42px}
    .titleRow{display:flex;align-items:flex-end;justify-content:space-between;gap:12px;flex-wrap:wrap}
    .section h2{
      margin:0;
      font-family:var(--font-title);
      font-size:24px;
      letter-spacing:.2px;
    }
    .section p{margin:8px 0 0;color:var(--muted);line-height:1.8;font-family:var(--font-body)}
    .toolbar{
      margin-top:14px;
      display:flex;gap:10px;flex-wrap:wrap;align-items:center;
    }
    .select, .input{
      border-radius: 16px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.06);
      color: var(--text);
      padding:12px 14px;
      outline:none;
      font-weight:800;
      font-family:var(--font-ui);
    }
    .input{flex: 1 1 260px;font-weight:700}
    .select{flex: 0 0 220px}

    .catRow{
      margin-top:14px;
      display:flex;gap:10px;flex-wrap:wrap;align-items:center;
      border:1px solid var(--line);
      background:rgba(255,255,255,.05);
      padding:10px;border-radius:999px;
      font-family:var(--font-ui);
    }
    .catBtn{
      border:0;cursor:pointer;
      padding:10px 12px;border-radius:999px;
      background:transparent;
      color:var(--muted);
      font-weight:900;
      display:inline-flex;gap:10px;align-items:center;
      font-family:var(--font-ui);
    }
    .catBtn.active{
      background: rgba(255,255,255,.10);
      color: var(--text);
    }

    .grid{
      display:grid;
      grid-template-columns:repeat(4,1fr);
      gap:12px;
      margin-top:14px;
    }
    .card{
      border-radius:22px;
      border:1px solid var(--line);
      background: linear-gradient(180deg, rgba(15,23,42,.92), rgba(2,6,23,.92));
      box-shadow: var(--shadow2);
      overflow:hidden;
      position:relative;
      transition:.15s ease;
    }
    .card:hover{transform:translateY(-2px)}
    .img{
      height:160px;
      background:
        radial-gradient(500px 220px at 50% 0%, rgba(255,255,255,.16), transparent 60%),
        linear-gradient(135deg, rgba(59,130,246,.22), rgba(236,72,153,.18));
      border-bottom:1px solid var(--line);
      position:relative;
      overflow:hidden;
    }
    .img .thumb{
      position:absolute; inset:0;
      background-size:cover;
      background-position:center;
    }
    .img i{
      position:absolute;inset:0;
      display:grid;place-items:center;
      font-size:38px;color:rgba(255,255,255,.9);
      text-shadow:0 10px 30px rgba(0,0,0,.35);
    }
    .off{
      position:absolute;top:10px;left:10px;
      padding:7px 10px;border-radius:999px;
      background: rgba(245,158,11,.18);
      border:1px solid rgba(245,158,11,.28);
      color:#fde68a;
      font-weight:900;font-size:12px;
      display:inline-flex;align-items:center;gap:8px;
      z-index:2;
      font-family:var(--font-ui);
    }
    .body{padding:12px}
    .pill{
      display:inline-flex;align-items:center;gap:8px;
      padding:7px 10px;border-radius:999px;
      background: rgba(59,130,246,.14);
      border:1px solid rgba(59,130,246,.25);
      color:#dbeafe;
      font-weight:900;font-size:12px;
      white-space:nowrap;
      font-family:var(--font-ui);
    }
    .body h4{
      margin:10px 0 6px;
      font-size:14.5px;line-height:1.25;
      font-family:var(--font-ui);
      letter-spacing:.1px;
    }
    .price{
      display:flex;align-items:baseline;gap:10px;flex-wrap:wrap;
      margin:6px 0 10px;
      font-family:var(--font-ui);
    }
    .sale{font-weight:900}
    .reg{color:var(--muted);text-decoration:line-through;font-size:12.5px}
    .actions{display:flex;gap:10px;flex-wrap:wrap}

    /* footer */
    footer{
      border-top:1px solid var(--line);
      background: rgba(0,0,0,.12);
      padding:18px 0;
      color:var(--muted);
      font-size:13px;
      font-family:var(--font-ui);
    }
    .footRow{display:flex;justify-content:space-between;gap:12px;flex-wrap:wrap;align-items:center}

    /* overlay/modal (details + admin) */
    .overlay{
      position:fixed;inset:0;z-index:200;
      display:none;align-items:center;justify-content:center;
      background:rgba(0,0,0,.68);
      padding:16px;
    }
    .overlay.show{display:flex}
    .modal{
      width:100%;max-width:1020px;
      border-radius:26px;
      border:1px solid var(--line);
      background:rgba(10,14,28,.96);
      box-shadow:var(--shadow);
      overflow:hidden;
    }
    .modalHead{
      padding:14px 14px;
      display:flex;align-items:center;justify-content:space-between;gap:12px;
      border-bottom:1px solid var(--line);
      font-family:var(--font-ui);
    }
    .modalHead b{font-size:16px}
    .xbtn{
      border:0;background:transparent;color:var(--muted);
      font-size:22px;cursor:pointer;line-height:1;
      padding:6px 10px;border-radius:12px;
      font-family:var(--font-ui);
    }
    .xbtn:hover{color:var(--text);background:rgba(255,255,255,.06)}
    .modalBody{padding:14px}
    .modalFoot{
      padding:14px;
      border-top:1px solid var(--line);
      background:rgba(0,0,0,.14);
      display:flex;gap:10px;justify-content:flex-end;flex-wrap:wrap;
    }
    .two{display:grid;grid-template-columns: 1fr 1fr;gap:12px;}
    .box{
      border-radius:20px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.05);
      padding:14px;
    }

    /* details hero */
    .pHero{
      border-radius:20px;border:1px solid var(--line);
      height:240px;
      background:
        radial-gradient(700px 280px at 50% 0%, rgba(255,255,255,.14), transparent 60%),
        linear-gradient(135deg, rgba(59,130,246,.20), rgba(236,72,153,.16));
      position:relative;
      overflow:hidden;
      display:grid;place-items:center;
    }
    .pHero .imgbg{
      position:absolute; inset:0;
      background-size:cover;
      background-position:center;
      opacity:.95;
      filter: contrast(1.05) saturate(1.1);
    }
    .pHero i{position:relative;z-index:1;font-size:54px;color:rgba(255,255,255,.92);text-shadow:0 10px 30px rgba(0,0,0,.35)}
    .specs{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
    .spec{
      display:inline-flex;align-items:center;gap:8px;
      padding:8px 10px;border-radius:999px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.06);
      font-weight:900;font-size:12px;
      color:#e5e7eb;
      white-space:nowrap;
      font-family:var(--font-ui);
    }

    /* form fields */
    .field{display:flex;flex-direction:column;gap:6px;margin-top:10px;}
    .field label{font-size:12px;color:var(--muted);font-weight:900;font-family:var(--font-ui)}
    .field input,.field select,.field textarea{
      border-radius:16px;border:1px solid var(--line);
      background:rgba(255,255,255,.06);
      color:var(--text);
      padding:12px 12px;
      outline:none;
      font-size:14px;
      font-family:var(--font-ui);
    }
    .field textarea{min-height:110px;resize:vertical;font-family:var(--font-body);}

    /* admin routing */
    .adminGrid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
      margin-top:12px;
    }
    .adminCard{
      border-radius:22px;
      border:1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04));
      padding:14px;
      box-shadow: var(--shadow2);
      cursor:pointer;
      transition:.15s ease;
    }
    .adminCard:hover{transform:translateY(-2px)}
    .adminCard b{font-family:var(--font-ui);font-size:14.5px}
    .adminCard p{margin:8px 0 0;color:var(--muted);line-height:1.7;font-family:var(--font-body);font-size:13.5px}

    .adminTopBar{
      display:flex;align-items:center;justify-content:space-between;gap:10px;flex-wrap:wrap;
      padding-bottom:10px;border-bottom:1px solid rgba(255,255,255,.08);
      margin-bottom:12px;
      font-family:var(--font-ui);
    }
    .crumb{
      display:flex;align-items:center;gap:10px;flex-wrap:wrap;
      font-weight:900;
    }
    .crumb .path{color:var(--muted);font-weight:800}

    .tableWrap{overflow:auto;border:1px solid var(--line);border-radius:18px;background:rgba(255,255,255,.04);margin-top:12px}
    table{width:100%;border-collapse:collapse;min-width:860px;font-family:var(--font-ui)}
    th,td{padding:12px 12px;border-bottom:1px solid rgba(255,255,255,.08);text-align:left;font-size:13px}
    th{color:#e5e7eb;font-weight:900;background:rgba(255,255,255,.04);position:sticky;top:0}
    td{color:var(--muted);vertical-align:top}
    .tActions{display:flex;gap:8px;flex-wrap:wrap}
    .miniBtn{
      border:1px solid var(--line);
      background:rgba(255,255,255,.06);
      color:var(--text);
      border-radius:999px;
      padding:7px 10px;
      font-weight:900;
      cursor:pointer;
      font-size:12px;
      white-space:nowrap;
      font-family:var(--font-ui);
    }
    .miniBtn.danger{border-color: rgba(236,72,153,.35); background: rgba(236,72,153,.12); color:#fecdd3}
    .miniBtn.ok{border-color: rgba(34,197,94,.35); background: rgba(34,197,94,.12); color:#bbf7d0}
    .miniBtn.warn{border-color: rgba(245,158,11,.35); background: rgba(245,158,11,.12); color:#fde68a}

    /* uploader (drag-drop) */
    .uploader{
      border:1px dashed rgba(255,255,255,.20);
      background: rgba(255,255,255,.05);
      border-radius:18px;
      padding:14px;
      display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap;
      font-family:var(--font-ui);
    }
    .uploader.drag{border-color: rgba(59,130,246,.7); background: rgba(59,130,246,.10)}
    .previewBox{
      width:76px;height:76px;border-radius:16px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.06);
      display:grid;place-items:center;
      overflow:hidden;
    }
    .previewBox img{width:100%;height:100%;object-fit:cover;display:none}
    .previewBox i{color:rgba(255,255,255,.85);font-size:24px}

    /* toast */
    .toastWrap{
      position:fixed;right:14px;bottom:14px;z-index:260;
      display:flex;flex-direction:column;gap:10px;
      max-width:min(420px, calc(100vw - 28px));
      font-family:var(--font-ui);
    }
    .toast{
      border-radius:18px;
      border:1px solid var(--line);
      background: rgba(10,14,28,.94);
      box-shadow: var(--shadow2);
      padding:12px 12px;
      display:flex;gap:10px;align-items:flex-start;
      animation: toastIn .18s ease-out;
    }
    .toast i{margin-top:2px}
    .toast .t{flex:1}
    .toast .t b{display:block;font-size:13px}
    .toast .t span{display:block;color:var(--muted);font-size:12.5px;line-height:1.55;margin-top:3px}
    .toast .x{
      border:0;background:transparent;color:var(--muted);
      cursor:pointer;font-size:18px;line-height:1;
      padding:4px 6px;border-radius:10px;
      font-family:var(--font-ui);
    }
    .toast .x:hover{color:var(--text);background:rgba(255,255,255,.06)}
    @keyframes toastIn{from{transform:translateY(6px);opacity:0}to{transform:translateY(0);opacity:1}}
    @keyframes toastOut{to{transform:translateY(6px);opacity:0}}

    /* responsive */
    @media (max-width: 980px){
      nav{display:none}
      .menu-btn{display:inline-flex}
      .mnav{display:block}
      .search{max-width:100%;flex:1 1 100%}
      .grid{grid-template-columns:repeat(2,1fr)}
      .two{grid-template-columns:1fr}
      .adminGrid{grid-template-columns:1fr}
      .cover{height:240px}
      .profileLogo{width:96px;height:96px}
      .profileText h1{font-size:30px}
    }
    @media (max-width: 560px){
      .grid{grid-template-columns:1fr}
      .cover{height:210px}
      .profileText h1{font-size:26px}
    }
  </style>
</head>

<body>
  <div class="topbar">
    <div class="inner">
      <div class="chip"><i class="fa-solid fa-shield-halved"></i> Safe Process</div>
      <div class="chip"><i class="fa-solid fa-bolt"></i> Fast Support</div>
      <div class="chip"><i class="fa-brands fa-whatsapp"></i> WhatsApp Order</div>
    </div>
  </div>

  <script>
    /***********************
     *  ADMIN LOGIN (FIXED)
     ***********************/
    const ADMIN_USER = "saikat@gmail.com";
    const ADMIN_PASS = "676711@";
    const ADMIN_SESSION_KEY = "saikat_admin_session_shopify_like_v1";

    /***********************
     *  STORAGE KEYS
     ***********************/
    const LS_SETTINGS   = "saikat_settings_v3";
    const LS_CATEGORIES = "saikat_categories_v3";
    const LS_PRODUCTS   = "saikat_products_v3";
    const LS_SERVICES   = "saikat_services_v3";

    const money = n => `${Number(n||0).toLocaleString("en-US")} Tk`;
    const escapeHtml = (str)=> String(str ?? "")
      .replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;")
      .replaceAll('"',"&quot;").replaceAll("'","&#039;");

    function toast(title, message, type="info", ms=2400){
      const wrap = document.getElementById("toastWrap");
      const icon = type==="success" ? "fa-circle-check" : type==="error" ? "fa-triangle-exclamation" : "fa-circle-info";
      const el = document.createElement("div");
      el.className = "toast";
      el.innerHTML = `
        <i class="fa-solid ${icon}"></i>
        <div class="t"><b>${escapeHtml(title)}</b><span>${escapeHtml(message)}</span></div>
        <button class="x" aria-label="Close">✕</button>
      `;
      const close = ()=>{ el.style.animation="toastOut .16s ease-in forwards"; setTimeout(()=>el.remove(),160); };
      el.querySelector(".x").addEventListener("click", close);
      wrap.appendChild(el);
      setTimeout(close, ms);
    }

    function readJSON(key, fallback){
      try{
        const raw = localStorage.getItem(key);
        if(!raw) return structuredClone(fallback);
        const obj = JSON.parse(raw);
        return obj ?? structuredClone(fallback);
      }catch{
        return structuredClone(fallback);
      }
    }
    function writeJSON(key, value){
      localStorage.setItem(key, JSON.stringify(value, null, 2));
    }
    function makeId(prefix="id"){
      return `${prefix}_${Math.random().toString(16).slice(2)}_${Date.now().toString(16)}`;
    }
    function percentOff(sale, reg){
      return (reg && reg>sale) ? Math.round(((reg-sale)/reg)*100) : 0;
    }
    function fileToDataUrl(file){
      return new Promise((resolve,reject)=>{
        const reader = new FileReader();
        reader.onload = ()=> resolve(String(reader.result||""));
        reader.onerror = ()=> reject(new Error("File read failed"));
        reader.readAsDataURL(file);
      });
    }

    /***********************
     *  DEFAULT DATA (Your numbers stay)
     ***********************/
    const DEFAULT_SETTINGS = {
      brandName: "Saikat Tech Hub",
      tagline: "Premium Digital Services • Products • Fast Support",
      waNumber: "8801804676711",
      waRaw: "01804676711",
      email: "saikat712@gmail.com",
      fb: "https://www.facebook.com/share/1AWbo99RjN/",
      address: "Dhaka New Market, 1205",
      payment: { bkash: "+8801344-486384", nagad: "01682312657" },
      logoDataUrl: "",
      coverDataUrl: ""
    };

    const DEFAULT_CATEGORIES = ["Gadget","Fashion","Kitchen","Home"];

    const DEFAULT_PRODUCTS = [
      { id:"p1", title:"Mobile Phone Holder", sku:"GAD-001", desc:"Strong grip • Universal", category:"Gadget", price:95, regular:240, image:"", tags:["Hot","Deal"] },
      { id:"p2", title:"Body Massager", sku:"HOM-002", desc:"Relax • Easy use", category:"Home", price:320, regular:550, image:"", tags:["Popular"] },
      { id:"p3", title:"Key Ring (Name/Phone)", sku:"FAS-010", desc:"Custom text", category:"Fashion", price:148, regular:390, image:"", tags:["Gift"] },
      { id:"p4", title:"Router Stand", sku:"GAD-009", desc:"Wall mount", category:"Gadget", price:499, regular:980, image:"", tags:["Premium"] }
    ];

    const DEFAULT_SERVICES = [
      { id:"fb_followers", category:"Facebook", icon:"fa-brands fa-facebook", title:"Facebook Followers", desc:"Page/Profile followers • Safe • No password", unitType:"K", pricePerUnit:120, qtyList:[1,2,3,4,5,6,7,8,9,10,20,30,40,50,70], tags:["Popular","Fast","Safe"], image:"" },
      { id:"fb_likes", category:"Facebook", icon:"fa-brands fa-facebook", title:"Facebook Likes", desc:"Page/Post likes • Social proof boost", unitType:"K", pricePerUnit:90, qtyList:[1,2,3,5,10,20,30,50], tags:["Trending","Quick","Boost"], image:"" },
      { id:"fb_reacts", category:"Facebook", icon:"fa-solid fa-heart", title:"Facebook Post Reactions", desc:"Like/Love/Wow • Engagement boost", unitType:"100", pricePerUnit:80, qtyList:[1,2,3,5,10,20,30,50], tags:["Engagement","Safe","Hot"], image:"" },
      { id:"fb_views", category:"Facebook", icon:"fa-solid fa-play", title:"Facebook Video Views", desc:"Views for video • Reach boost", unitType:"K", pricePerUnit:25, qtyList:[10,20,50,100,200], tags:["Reach","Fast","Boost"], image:"" },

      { id:"yt_subs", category:"YouTube", icon:"fa-brands fa-youtube", title:"YouTube Subscribers", desc:"Channel subs • Promotional growth", unitType:"K", pricePerUnit:350, qtyList:[1,2,3,5,10], tags:["YouTube","Growth","Safe"], image:"" },
      { id:"yt_views", category:"YouTube", icon:"fa-brands fa-youtube", title:"YouTube Views", desc:"Video views • Improve reach", unitType:"K", pricePerUnit:60, qtyList:[10,20,50,100,200], tags:["Views","Reach","Fast"], image:"" },

      { id:"ig_followers", category:"Instagram", icon:"fa-brands fa-instagram", title:"Instagram Followers", desc:"Followers • Boost profile", unitType:"K", pricePerUnit:220, qtyList:[1,2,3,5,10,20], tags:["IG","Popular","Safe"], image:"" },
      { id:"ig_likes", category:"Instagram", icon:"fa-brands fa-instagram", title:"Instagram Likes", desc:"Post likes • Social proof", unitType:"K", pricePerUnit:120, qtyList:[1,2,3,5,10,20], tags:["Likes","Quick","Boost"], image:"" },

      { id:"tt_followers", category:"TikTok", icon:"fa-brands fa-tiktok", title:"TikTok Followers", desc:"Followers • Boost account", unitType:"K", pricePerUnit:250, qtyList:[1,2,3,5,10,20], tags:["TikTok","Growth","Fast"], image:"" },
      { id:"tt_likes", category:"TikTok", icon:"fa-brands fa-tiktok", title:"TikTok Likes", desc:"Video likes • Improve engagement", unitType:"K", pricePerUnit:140, qtyList:[1,2,3,5,10,20], tags:["Engagement","Boost","Hot"], image:"" },

      { id:"boosting", category:"Marketing", icon:"fa-solid fa-bolt", title:"Boosting / Promotion", desc:"Boost post/page • Reach & engagement", unitType:"PACK",
        packages:[{label:"Basic Boost",price:300,note:"Target + basic setup"},{label:"Standard Boost",price:700,note:"Better reach + optimize"},{label:"Premium Boost",price:1500,note:"Best reach + guidance"}],
        tags:["Boosting","Ads","Support"], image:""
      },
      { id:"ad_manager", category:"Marketing", icon:"fa-solid fa-rectangle-ad", title:"Ads Manager / Campaign Setup", desc:"Ad setup + audience + optimization", unitType:"PACK",
        packages:[{label:"Single Campaign Setup",price:1200,note:"1 campaign + 1 adset"},{label:"Full Funnel Setup",price:2500,note:"Multiple adset + optimize"},{label:"Monthly Management",price:6000,note:"Weekly optimize + report"}],
        tags:["Ad Manager","Pro","Strategy"], image:""
      },

      { id:"video_edit", category:"Editing", icon:"fa-solid fa-scissors", title:"Video Editing", desc:"Reels/Shorts + Long video editing", unitType:"PACK",
        packages:[{label:"Reels/Shorts (30–60s)",price:200,note:"Clean cut + music sync"},{label:"Reels Pro (Caption + Effects)",price:350,note:"Captions + transitions"},{label:"Long Video (5–10 min)",price:900,note:"Pro edit + HD export"}],
        tags:["Creator","Premium","Fast"], image:""
      },
      { id:"photo_edit", category:"Editing", icon:"fa-solid fa-image", title:"Photo Editing", desc:"Background remove • Retouch • Product edit", unitType:"PACK",
        packages:[{label:"1 Photo",price:70,note:"Basic clean edit"},{label:"10 Photos",price:600,note:"Best value"},{label:"30 Photos",price:1600,note:"Bulk + priority"}],
        tags:["Clean","Pro","Value"], image:""
      },
      { id:"ai_content", category:"AI", icon:"fa-solid fa-wand-magic-sparkles", title:"AI Content / Caption / Hashtags", desc:"Brand tone captions & content", unitType:"PACK",
        packages:[{label:"10 Captions",price:250,note:"Hashtags included"},{label:"30 Captions",price:650,note:"Consistent brand tone"},{label:"10 AI Images",price:450,note:"Social-ready images"}],
        tags:["AI","Unique","Quick"], image:""
      }
    ];

    // Runtime state
    let settings   = readJSON(LS_SETTINGS, DEFAULT_SETTINGS);
    let categories = readJSON(LS_CATEGORIES, DEFAULT_CATEGORIES);
    let products   = readJSON(LS_PRODUCTS, DEFAULT_PRODUCTS);
    let services   = readJSON(LS_SERVICES, DEFAULT_SERVICES);

    const waBase = ()=> `https://wa.me/${settings.waNumber}`;
    const saveAll = ()=>{
      writeJSON(LS_SETTINGS, settings);
      writeJSON(LS_CATEGORIES, categories);
      writeJSON(LS_PRODUCTS, products);
      writeJSON(LS_SERVICES, services);
      applyStoreUI();
      renderServices();
      renderProducts();
      rebuildProductCategoryFilter();
      rebuildServiceCategoryChips();
    };

    function isAdmin(){ return sessionStorage.getItem(ADMIN_SESSION_KEY)==="1"; }
    function setAdminSession(on){ sessionStorage.setItem(ADMIN_SESSION_KEY, on ? "1" : "0"); }
  </script>

  <header>
    <div class="container">
      <div class="head">
        <div class="brand">
          <div class="logoBox" id="hdrLogoBox">
            <div class="fallback" id="hdrLogoFallback">S</div>
            <img id="hdrLogoImg" alt="Logo" />
          </div>
          <div class="brandTitle">
            <b id="hdrBrandName">Saikat Tech Hub</b>
            <span id="hdrTagline">Premium Digital Services</span>
          </div>
        </div>

        <button class="menu-btn" id="menuBtn"><i class="fa-solid fa-bars"></i> Menu</button>

        <nav aria-label="Main navigation">
          <a href="#services">Services</a>
          <a href="#products">Products</a>
          <a href="#contact">Contact</a>
        </nav>

        <div class="search">
          <i class="fa-solid fa-magnifying-glass"></i>
          <input id="qAll" placeholder="Search services/products..." />
        </div>

        <a class="btn wa" id="waTop" target="_blank" rel="noreferrer" href="#">
          <i class="fa-brands fa-whatsapp"></i> WhatsApp
        </a>
      </div>

      <div class="mnav" id="mnav">
        <a href="#services">Services</a>
        <a href="#products">Products</a>
        <a href="#contact">Contact</a>
      </div>
    </div>
  </header>

  <!-- Customer Cover + Logo -->
  <section class="coverWrap" id="top">
    <div class="container">
      <div class="coverCard">
        <div class="cover">
          <div class="coverImg" id="coverImg"></div>
        </div>

        <div class="profileRow">
          <div class="profileLogo">
            <div class="pfFallback" id="pfFallback">S</div>
            <img id="pfLogo" alt="Profile Logo" />
          </div>

          <div class="profileText">
            <h1 id="heroName"><span class="glowText">Saikat</span> Tech Hub</h1>
            <div class="tagline" id="heroTagline">Premium Digital Services • Products • Fast Support</div>
            <div class="muted bn" style="font-size:13.5px;line-height:1.8">
              ✅ পাসওয়ার্ড লাগবে না (সার্ভিসে) • ✅ দ্রুত সাপোর্ট • ✅ সেফ প্রসেস
            </div>
          </div>

          <div class="profileActions">
            <a class="btn pink" href="#services"><i class="fa-solid fa-bolt"></i> Services</a>
            <a class="btn primary" href="#products"><i class="fa-solid fa-bag-shopping"></i> Products</a>
            <button class="btn ghost" id="openAdmin"><i class="fa-solid fa-gear"></i> Admin</button>
          </div>
        </div>

        <div class="container" style="padding-top:0">
          <div style="display:flex;gap:10px;flex-wrap:wrap;padding:0 0 18px">
            <span class="chip"><i class="fa-solid fa-location-dot"></i> <span id="addrShow"></span></span>
            <span class="chip"><i class="fa-solid fa-envelope"></i> <span id="emailShow"></span></span>
            <span class="chip"><i class="fa-brands fa-whatsapp"></i> <span id="waShow"></span></span>
            <span class="chip"><i class="fa-solid fa-wallet"></i> bKash: <span id="bkashShow"></span></span>
            <span class="chip"><i class="fa-solid fa-money-bill-wave"></i> Nagad: <span id="nagadShow"></span></span>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Services -->
  <section class="section" id="services">
    <div class="container">
      <div class="titleRow">
        <div>
          <h2>Social Media Services</h2>
          <p class="bn">ক্যাটাগরি সিলেক্ট করে সার্ভিসে ক্লিক করুন → অর্ডার ফর্ম → WhatsApp</p>
        </div>
        <span class="chip"><i class="fa-solid fa-hand-pointer"></i> Easy Order</span>
      </div>

      <div class="catRow" id="svcCats"></div>

      <div class="toolbar">
        <input class="input" id="qServices" placeholder="Search services (followers, likes, boosting)..." />
        <button class="btn ghost" id="svcClear"><i class="fa-solid fa-rotate-left"></i> Clear</button>
      </div>

      <div class="grid" id="servicesGrid"></div>
    </div>
  </section>

  <!-- Products -->
  <section class="section" id="products">
    <div class="container">
      <div class="titleRow">
        <div>
          <h2>Products</h2>
          <p class="bn">প্রোডাক্ট দেখুন → Details → WhatsApp এ অর্ডার (COD/Online)</p>
        </div>
        <span class="chip"><i class="fa-solid fa-tag"></i> Categories</span>
      </div>

      <div class="toolbar">
        <input class="input" id="qProducts" placeholder="Search products..." />
        <select class="select" id="pCat">
          <option value="ALL">All Categories</option>
        </select>
        <button class="btn ghost" id="pClear"><i class="fa-solid fa-rotate-left"></i> Clear</button>
      </div>

      <div class="grid" id="productsGrid"></div>
    </div>
  </section>

  <!-- Contact -->
  <section class="section" id="contact">
    <div class="container">
      <div class="titleRow">
        <div>
          <h2>Contact</h2>
          <p class="bn">সাপোর্ট/অর্ডার নিতে WhatsApp / Facebook / Email ব্যবহার করুন</p>
        </div>
        <span class="chip"><i class="fa-solid fa-headset"></i> Support</span>
      </div>

      <div class="grid" style="grid-template-columns:repeat(3,1fr)">
        <div class="card">
          <div class="body">
            <h4><i class="fa-brands fa-whatsapp"></i> WhatsApp</h4>
            <div class="muted bn" style="font-size:13px;line-height:1.7">Tap করলে WhatsApp chat ওপেন হবে।</div>
            <div class="actions" style="margin-top:12px">
              <a class="btn wa" id="waContact" target="_blank" rel="noreferrer" href="#"><i class="fa-brands fa-whatsapp"></i> Chat Now</a>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="body">
            <h4><i class="fa-brands fa-facebook"></i> Facebook</h4>
            <div class="muted bn" style="font-size:13px;line-height:1.7">Tap করলে Facebook Page ওপেন হবে।</div>
            <div class="actions" style="margin-top:12px">
              <a class="btn primary" id="fbContact" target="_blank" rel="noreferrer" href="#"><i class="fa-brands fa-facebook"></i> Visit Page</a>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="body">
            <h4><i class="fa-solid fa-envelope"></i> Email</h4>
            <div class="muted bn" style="font-size:13px;line-height:1.7">Tap করলে Email compose ওপেন হবে।</div>
            <div class="actions" style="margin-top:12px">
              <a class="btn ghost" id="emailBtn" href="#"><i class="fa-solid fa-envelope"></i> Send Email</a>
            </div>
          </div>
        </div>
      </div>

    </div>
  </section>

  <footer>
    <div class="container">
      <div class="footRow">
        <div>© 2026 <span id="footBrand"></span> — All Rights Reserved</div>
        <div style="display:flex;gap:10px;flex-wrap:wrap;align-items:center">
          <a href="#top" class="chip"><i class="fa-solid fa-arrow-up"></i> Back to top</a>
          <button class="chip" id="openAdmin2"><i class="fa-solid fa-gear"></i> Admin</button>
        </div>
      </div>
    </div>
  </footer>

  <!-- DETAILS (Product + Service order) -->
  <div class="overlay" id="detailOverlay" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="detailTitle">
      <div class="modalHead">
        <b id="detailTitle">Details</b>
        <button class="xbtn" id="closeDetail" aria-label="Close">✕</button>
      </div>

      <div class="modalBody">
        <div class="two">
          <div class="box">
            <div class="pHero">
              <div class="imgbg" id="detailImg"></div>
              <i class="fa-solid fa-box" id="detailIcon"></i>
            </div>
            <div class="specs" id="detailTags"></div>
          </div>

          <div class="box">
            <div class="pill" id="detailPill"><i class="fa-solid fa-layer-group"></i> Category</div>
            <h3 style="margin:10px 0 6px;font-size:20px;line-height:1.25;font-family:var(--font-title)" id="detailName">Name</h3>
            <div class="muted" style="line-height:1.8" id="detailDesc">Description</div>

            <!-- Product area -->
            <div id="detailProductArea" style="display:none;margin-top:12px">
              <div class="price">
                <span class="sale" id="detailSale">0 Tk</span>
                <span class="reg" id="detailReg" style="display:none">0 Tk</span>
              </div>
              <div class="muted" id="detailOff" style="font-size:12.5px"></div>

              <div class="field" style="margin-top:12px">
                <label>Payment Method</label>
                <select id="prodPay">
                  <option value="COD">Cash on Delivery (COD)</option>
                  <option value="bKash">bKash</option>
                  <option value="Nagad">Nagad</option>
                </select>
              </div>

              <div class="field" id="prodTrxField" style="display:none">
                <label>Transaction ID (only for bKash/Nagad)</label>
                <input id="prodTrx" placeholder="e.g. A1B2C3D4" />
              </div>

              <div class="field">
                <label>Customer Details (Name + Address)</label>
                <textarea id="prodNote" placeholder="আপনার নাম, ঠিকানা, মোবাইল, যেকোন নোট..."></textarea>
              </div>

              <div class="actions" style="margin-top:12px">
                <button class="btn wa" id="prodBuy"><i class="fa-brands fa-whatsapp"></i> Order on WhatsApp</button>
                <button class="btn ghost" id="detailCloseBtn"><i class="fa-solid fa-xmark"></i> Close</button>
              </div>
              <div class="muted bn" style="margin-top:10px;font-size:12.5px;line-height:1.6">
                Online payment হলে TrxID দিন। COD হলে TrxID লাগবে না।
              </div>
            </div>

            <!-- Service area -->
            <div id="detailServiceArea" style="display:none;margin-top:12px">
              <div class="field" id="svcQtyWrap">
                <label id="svcQtyLabel">Quantity</label>
                <select id="svcQty"></select>
              </div>

              <div class="field" id="svcPkgField" style="display:none">
                <label>Package</label>
                <select id="svcPkg"></select>
              </div>

              <div class="field">
                <label>Price</label>
                <input id="svcPrice" readonly />
              </div>

              <div class="field">
                <label>Link / URL (Page/Profile/Post/Video)</label>
                <input id="svcUrl" placeholder="Paste your URL here" />
              </div>

              <div class="field">
                <label>Payment Method</label>
                <select id="svcPay">
                  <option value="">Select</option>
                  <option value="bKash">bKash</option>
                  <option value="Nagad">Nagad</option>
                </select>
              </div>

              <div class="field">
                <label>Transaction ID (TrxID)</label>
                <input id="svcTrx" placeholder="e.g. A1B2C3D4" />
              </div>

              <div class="field">
                <label>Extra Notes (optional)</label>
                <textarea id="svcNote" placeholder="Target country / speed / any notes..."></textarea>
              </div>

              <div class="muted bn" style="font-size:12.5px;line-height:1.6;margin-top:10px">
                Payment Numbers: bKash <b style="color:var(--text)"><span id="svcBkash"></span></b> • Nagad <b style="color:var(--text)"><span id="svcNagad"></span></b>
              </div>

              <div class="actions" style="margin-top:12px">
                <button class="btn wa" id="svcSend"><i class="fa-brands fa-whatsapp"></i> Send Order to WhatsApp</button>
                <button class="btn ghost" id="svcClose"><i class="fa-solid fa-xmark"></i> Close</button>
              </div>
            </div>

          </div>
        </div>
      </div>

      <div class="modalFoot"></div>
    </div>
  </div>

  <!-- ADMIN (Login + Dashboard + Pages) -->
  <div class="overlay" id="adminOverlay" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="adminTitle">
      <div class="modalHead">
        <b id="adminTitle"><i class="fa-solid fa-shield-halved"></i> Admin</b>
        <button class="xbtn" id="closeAdmin" aria-label="Close">✕</button>
      </div>

      <div class="modalBody">
        <!-- LOGIN VIEW -->
        <div id="adminLoginView">
          <div class="box">
            <b style="font-size:16px;font-family:var(--font-ui)"><i class="fa-solid fa-lock"></i> Login</b>
            <div class="muted bn" style="margin-top:6px;line-height:1.7">শুধু আপনি Admin access পাবেন।</div>

            <div class="two" style="margin-top:12px">
              <div class="box">
                <div class="field">
                  <label>Username</label>
                  <input id="adminUser" placeholder="saikat@gmail.com" />
                </div>
                <div class="field">
                  <label>Password</label>
                  <div style="display:flex;gap:10px;align-items:center">
                    <input id="adminPass" type="password" placeholder="••••••••" style="flex:1" />
                    <button class="miniBtn" id="togglePass" type="button" title="Show/Hide password">
                      <i class="fa-solid fa-eye"></i>
                    </button>
                  </div>
                </div>

                <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:12px">
                  <button class="btn primary" id="adminLoginBtn"><i class="fa-solid fa-right-to-bracket"></i> Login</button>
                  <button class="btn ghost" id="adminCloseBtn"><i class="fa-solid fa-xmark"></i> Close</button>
                </div>

                <div class="muted" style="margin-top:10px;font-size:12.5px;line-height:1.6">
                  Tip: Username/password ঠিকভাবে দিন (স্পেস না)।
                </div>
              </div>

              <div class="box">
                <b><i class="fa-solid fa-list-check"></i> What you can edit</b>
                <div class="muted bn" style="margin-top:8px;line-height:1.8">
                  ✅ Logo + Cover + Tagline<br/>
                  ✅ Products (image, name, SKU, price, description, category)<br/>
                  ✅ Categories (Gadget/Fashion/Kitchen/Home + add new)<br/>
                  ✅ Services (price, packages, qty list)<br/>
                  ✅ Payment numbers, Address, Contact links
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- APP VIEW -->
        <div id="adminAppView" style="display:none">
          <div class="adminTopBar">
            <div class="crumb">
              <span><i class="fa-solid fa-gear"></i> Admin</span>
              <span class="path" id="adminPath">Dashboard</span>
            </div>
            <div style="display:flex;gap:10px;flex-wrap:wrap">
              <button class="btn warn" id="adminReset"><i class="fa-solid fa-rotate-left"></i> Reset Default</button>
              <button class="btn ghost" id="adminLogout"><i class="fa-solid fa-arrow-right-from-bracket"></i> Logout</button>
            </div>
          </div>

          <!-- DASHBOARD -->
          <div id="adminDashboard">
            <div class="adminGrid">
              <div class="adminCard" data-route="branding">
                <b><i class="fa-solid fa-image"></i> Branding (Logo + Cover)</b>
                <p class="bn">Logo/Cover আপলোড করুন (Drag & Drop + Choose)</p>
              </div>
              <div class="adminCard" data-route="store">
                <b><i class="fa-solid fa-store"></i> Store Info (Name/Tagline)</b>
                <p class="bn">Brand name, tagline ইত্যাদি</p>
              </div>
              <div class="adminCard" data-route="products">
                <b><i class="fa-solid fa-bag-shopping"></i> Products</b>
                <p class="bn">Add/Edit/Delete + SKU + Category + Image</p>
              </div>
              <div class="adminCard" data-route="categories">
                <b><i class="fa-solid fa-tags"></i> Categories</b>
                <p class="bn">Gadget/Fashion/Kitchen/Home + add new</p>
              </div>
              <div class="adminCard" data-route="services">
                <b><i class="fa-solid fa-bolt"></i> Social Media Services</b>
                <p class="bn">Rate/Packages/Qty list/Description edit</p>
              </div>
              <div class="adminCard" data-route="payments">
                <b><i class="fa-solid fa-wallet"></i> Payments</b>
                <p class="bn">bKash/Nagad নাম্বার পরিবর্তন</p>
              </div>
              <div class="adminCard" data-route="contact">
                <b><i class="fa-solid fa-address-card"></i> Contact / Address</b>
                <p class="bn">WhatsApp/Email/Facebook/Address</p>
              </div>
            </div>
          </div>

          <!-- PAGES (route-based) -->
          <div id="adminPage" style="display:none"></div>
        </div>
      </div>

      <div class="modalFoot">
        <button class="btn ghost" id="adminBack" style="display:none"><i class="fa-solid fa-arrow-left"></i> Back</button>
        <button class="btn ghost" id="adminCloseBtn2"><i class="fa-solid fa-xmark"></i> Close</button>
      </div>
    </div>
  </div>

  <div class="toastWrap" id="toastWrap" aria-live="polite" aria-atomic="true"></div>

  <script>
    /* -------- header menu -------- */
    const menuBtn = document.getElementById("menuBtn");
    const mnav = document.getElementById("mnav");
    menuBtn.addEventListener("click", ()=> mnav.classList.toggle("show"));
    mnav.addEventListener("click", (e)=>{ if(e.target.tagName==="A") mnav.classList.remove("show"); });

    /* -------- store apply -------- */
    function applyStoreUI(){
      // header text
      document.getElementById("hdrBrandName").textContent = settings.brandName || "Saikat Tech Hub";
      document.getElementById("hdrTagline").textContent = settings.tagline || "";
      document.getElementById("heroName").innerHTML = `<span class="glowText">${escapeHtml((settings.brandName||"Saikat").split(" ")[0])}</span> ${escapeHtml((settings.brandName||"Tech Hub").split(" ").slice(1).join(" ")||"Tech Hub")}`.trim();
      document.getElementById("heroTagline").textContent = settings.tagline || "";

      // cover
      const coverEl = document.getElementById("coverImg");
      coverEl.style.backgroundImage = settings.coverDataUrl ? `url('${settings.coverDataUrl}')` : "";

      // logos (header + profile)
      const hdrImg = document.getElementById("hdrLogoImg");
      const hdrFallback = document.getElementById("hdrLogoFallback");
      const pfImg = document.getElementById("pfLogo");
      const pfFallback = document.getElementById("pfFallback");

      if(settings.logoDataUrl){
        hdrImg.src = settings.logoDataUrl; hdrImg.style.display="block"; hdrFallback.style.display="none";
        pfImg.src = settings.logoDataUrl; pfImg.style.display="block"; pfFallback.style.display="none";
      }else{
        hdrImg.style.display="none"; hdrFallback.style.display="grid";
        pfImg.style.display="none"; pfFallback.style.display="grid";
        const initial = (settings.brandName||"S").trim().slice(0,1).toUpperCase();
        hdrFallback.textContent = initial;
        pfFallback.textContent = initial;
      }

      // contact chips
      document.getElementById("addrShow").textContent = settings.address || "";
      document.getElementById("emailShow").textContent = settings.email || "";
      document.getElementById("waShow").textContent = settings.waRaw || "";
      document.getElementById("bkashShow").textContent = settings.payment?.bkash || "";
      document.getElementById("nagadShow").textContent = settings.payment?.nagad || "";

      // links
      document.getElementById("waTop").href = waBase();
      document.getElementById("waContact").href = waBase();
      document.getElementById("fbContact").href = settings.fb || "#";
      document.getElementById("emailBtn").href = `mailto:${settings.email}?subject=${encodeURIComponent("Inquiry - " + (settings.brandName||"Saikat Tech Hub"))}`;

      // service payment (details modal)
      document.getElementById("svcBkash").textContent = settings.payment?.bkash || "";
      document.getElementById("svcNagad").textContent = settings.payment?.nagad || "";

      document.getElementById("footBrand").textContent = settings.brandName || "Saikat Tech Hub";
    }

    /* -------- services render -------- */
    const servicesGrid = document.getElementById("servicesGrid");
    const svcCats = document.getElementById("svcCats");
    const qServices = document.getElementById("qServices");
    let activeSvcCat = "ALL";

    function uniqServiceCats(){
      const s = new Set(services.map(x=>x.category||"Other"));
      return ["ALL", ...[...s].sort((a,b)=>a.localeCompare(b))];
    }
    function iconForSvcCat(cat){
      return cat==="Facebook" ? "fa-brands fa-facebook"
        : cat==="YouTube" ? "fa-brands fa-youtube"
        : cat==="Instagram" ? "fa-brands fa-instagram"
        : cat==="TikTok" ? "fa-brands fa-tiktok"
        : cat==="Marketing" ? "fa-solid fa-rectangle-ad"
        : cat==="Editing" ? "fa-solid fa-scissors"
        : cat==="AI" ? "fa-solid fa-wand-magic-sparkles"
        : "fa-solid fa-layer-group";
    }
    function rebuildServiceCategoryChips(){
      const cats = uniqServiceCats();
      svcCats.innerHTML = cats.map(c=>`
        <button class="catBtn ${c===activeSvcCat?"active":""}" data-cat="${escapeHtml(c)}">
          <i class="${iconForSvcCat(c)}"></i> ${escapeHtml(c)}
        </button>
      `).join("");
    }

    svcCats.addEventListener("click",(e)=>{
      const b = e.target.closest("[data-cat]");
      if(!b) return;
      activeSvcCat = b.getAttribute("data-cat") || "ALL";
      rebuildServiceCategoryChips();
      renderServices();
    });

    function matchesQuery(it, q){
      const qq = (q||"").trim().toLowerCase();
      if(!qq) return true;
      const hay = [
        it.title, it.desc, it.category,
        Array.isArray(it.tags) ? it.tags.join(" ") : ""
      ].join(" ").toLowerCase();
      return hay.includes(qq);
    }

    function serviceCard(s){
      const badge = s.category || "Service";
      const icon = s.icon || iconForSvcCat(badge);
      const thumb = s.image ? `<div class="thumb" style="background-image:url('${s.image}')"></div>` : "";
      return `
        <div class="card">
          <div class="img">
            ${thumb}
            <i class="${icon}"></i>
          </div>
          <div class="body">
            <div class="pill"><i class="fa-solid fa-layer-group"></i> ${escapeHtml(badge)}</div>
            <h4>${escapeHtml(s.title)}</h4>
            <div class="muted bn" style="font-size:13px;line-height:1.7">${escapeHtml(s.desc)}</div>
            <div class="actions" style="margin-top:10px">
              <button class="btn wa small" data-open-service="${escapeHtml(s.id)}"><i class="fa-brands fa-whatsapp"></i> Order</button>
              <button class="btn ghost small" data-info-service="${escapeHtml(s.id)}"><i class="fa-solid fa-circle-info"></i> Info</button>
            </div>
          </div>
        </div>
      `;
    }

    function renderServices(){
      const q = qServices.value || "";
      let list = services.filter(s => matchesQuery(s,q));
      if(activeSvcCat!=="ALL"){
        list = list.filter(s => (s.category||"Other")===activeSvcCat);
      }
      servicesGrid.innerHTML = list.length
        ? list.map(serviceCard).join("")
        : `<div class="card" style="grid-column:1/-1"><div class="body"><h4>No services found</h4><p class="muted bn">Search/Category filter এর কারণে কিছু পাওয়া যায়নি।</p></div></div>`;
    }

    document.getElementById("svcClear").addEventListener("click", ()=>{
      qServices.value=""; activeSvcCat="ALL";
      rebuildServiceCategoryChips(); renderServices();
      toast("Cleared","Service filter reset ✅","success",1200);
    });
    qServices.addEventListener("input", renderServices);

    /* -------- products render -------- */
    const productsGrid = document.getElementById("productsGrid");
    const qProducts = document.getElementById("qProducts");
    const pCat = document.getElementById("pCat");
    let activePCat = "ALL";

    function rebuildProductCategoryFilter(){
      const cats = ["ALL", ...categories.filter(Boolean)];
      pCat.innerHTML = cats.map(c=>`<option value="${escapeHtml(c)}">${escapeHtml(c==="ALL"?"All Categories":c)}</option>`).join("");
      if(!cats.includes(activePCat)) activePCat="ALL";
      pCat.value = activePCat;
    }

    function productCard(p){
      const off = percentOff(p.price, p.regular);
      const offBadge = off ? `<div class="off"><i class="fa-solid fa-bolt"></i> ${off}% OFF</div>` : ``;
      const thumb = p.image ? `<div class="thumb" style="background-image:url('${p.image}')"></div>` : "";
      return `
        <div class="card">
          <div class="img">
            ${thumb}
            ${offBadge}
            <i class="fa-solid fa-box"></i>
          </div>
          <div class="body">
            <div class="pill"><i class="fa-solid fa-tag"></i> ${escapeHtml(p.category||"General")}</div>
            <h4>${escapeHtml(p.title)}</h4>
            <div class="muted" style="font-size:12.5px;margin-top:4px">SKU: <b style="color:var(--text)">${escapeHtml(p.sku||"")}</b></div>
            <div class="price">
              <span class="sale">${money(p.price)}</span>
              ${p.regular ? `<span class="reg">${money(p.regular)}</span>` : ``}
            </div>
            <div class="actions">
              <button class="btn pink small" data-open-product="${escapeHtml(p.id)}"><i class="fa-solid fa-circle-info"></i> Details</button>
            </div>
          </div>
        </div>
      `;
    }

    function renderProducts(){
      const q = qProducts.value || "";
      let list = products.filter(p => matchesQuery(p,q));
      if(activePCat!=="ALL"){
        list = list.filter(p => (p.category||"General")===activePCat);
      }
      productsGrid.innerHTML = list.length
        ? list.map(productCard).join("")
        : `<div class="card" style="grid-column:1/-1"><div class="body"><h4>No products found</h4><p class="muted bn">Search/Category filter এর কারণে কিছু পাওয়া যায়নি।</p></div></div>`;
    }

    pCat.addEventListener("change", ()=>{
      activePCat = pCat.value || "ALL";
      renderProducts();
    });
    qProducts.addEventListener("input", renderProducts);

    document.getElementById("pClear").addEventListener("click", ()=>{
      qProducts.value=""; activePCat="ALL";
      rebuildProductCategoryFilter(); renderProducts();
      toast("Cleared","Product filter reset ✅","success",1200);
    });

    /* -------- global search (header) -------- */
    const qAll = document.getElementById("qAll");
    qAll.addEventListener("input", ()=>{
      qServices.value = qAll.value;
      qProducts.value = qAll.value;
      renderServices();
      renderProducts();
    });

    /* -------- details modal logic -------- */
    const detailOverlay = document.getElementById("detailOverlay");
    const closeDetail = document.getElementById("closeDetail");
    const detailCloseBtn = document.getElementById("detailCloseBtn");
    const svcClose = document.getElementById("svcClose");
    closeDetail.addEventListener("click", ()=> detailOverlay.classList.remove("show"));
    detailCloseBtn.addEventListener("click", ()=> detailOverlay.classList.remove("show"));
    svcClose.addEventListener("click", ()=> detailOverlay.classList.remove("show"));
    detailOverlay.addEventListener("click", (e)=>{ if(e.target===detailOverlay) detailOverlay.classList.remove("show"); });

    const detailTitle = document.getElementById("detailTitle");
    const detailImg = document.getElementById("detailImg");
    const detailIcon = document.getElementById("detailIcon");
    const detailTags = document.getElementById("detailTags");
    const detailPill = document.getElementById("detailPill");
    const detailName = document.getElementById("detailName");
    const detailDesc = document.getElementById("detailDesc");

    const detailProductArea = document.getElementById("detailProductArea");
    const detailServiceArea = document.getElementById("detailServiceArea");

    const detailSale = document.getElementById("detailSale");
    const detailReg = document.getElementById("detailReg");
    const detailOff = document.getElementById("detailOff");

    // Product order fields
    const prodPay = document.getElementById("prodPay");
    const prodTrxField = document.getElementById("prodTrxField");
    const prodTrx = document.getElementById("prodTrx");
    const prodNote = document.getElementById("prodNote");
    const prodBuy = document.getElementById("prodBuy");

    prodPay.addEventListener("change", ()=>{
      prodTrxField.style.display = (prodPay.value==="COD") ? "none" : "block";
    });

    // Service order fields
    const svcQtyWrap = document.getElementById("svcQtyWrap");
    const svcQtyLabel = document.getElementById("svcQtyLabel");
    const svcQty = document.getElementById("svcQty");
    const svcPkgField = document.getElementById("svcPkgField");
    const svcPkg = document.getElementById("svcPkg");
    const svcPrice = document.getElementById("svcPrice");
    const svcUrl = document.getElementById("svcUrl");
    const svcPay = document.getElementById("svcPay");
    const svcTrx = document.getElementById("svcTrx");
    const svcNote = document.getElementById("svcNote");
    const svcSend = document.getElementById("svcSend");

    let currentDetail = null;
    let svcComputed = { label:"", price:0 };

    function openProductDetail(p){
      currentDetail = { mode:"product", id:p.id };
      detailTitle.textContent = "Product Order";
      detailPill.innerHTML = `<i class="fa-solid fa-tag"></i> ${escapeHtml(p.category||"General")}`;
      detailName.textContent = p.title || "Product";
      detailDesc.textContent = p.desc || "";
      detailIcon.className = "fa-solid fa-box";

      if(p.image){
        detailImg.style.backgroundImage = `url('${p.image}')`;
        detailImg.style.display="block";
      }else{
        detailImg.style.backgroundImage = "";
        detailImg.style.display="none";
      }

      const tags = Array.isArray(p.tags) ? p.tags : [];
      detailTags.innerHTML = [
        `<span class="spec"><i class="fa-solid fa-barcode"></i> SKU: ${escapeHtml(p.sku||"")}</span>`,
        `<span class="spec"><i class="fa-solid fa-tag"></i> ${escapeHtml(p.category||"")}</span>`,
        ...tags.slice(0,8).map(t=>`<span class="spec"><i class="fa-solid fa-circle-check"></i> ${escapeHtml(t)}</span>`)
      ].join("");

      detailProductArea.style.display = "block";
      detailServiceArea.style.display = "none";

      detailSale.textContent = money(p.price);
      if(p.regular){ detailReg.style.display="inline"; detailReg.textContent = money(p.regular); }
      else detailReg.style.display="none";
      const off = percentOff(p.price,p.regular);
      detailOff.textContent = off ? `${off}% OFF available` : "";

      prodPay.value = "COD";
      prodTrxField.style.display = "none";
      prodTrx.value = "";
      prodNote.value = "";

      detailOverlay.classList.add("show");
    }

    function openServiceDetail(s){
      currentDetail = { mode:"service", id:s.id };
      svcComputed = { label:"", price:0 };

      detailTitle.textContent = "Service Order";
      detailPill.innerHTML = `<i class="fa-solid fa-layer-group"></i> ${escapeHtml(s.category||"Service")}`;
      detailName.textContent = s.title || "Service";
      detailDesc.textContent = s.desc || "";
      detailIcon.className = s.icon ? s.icon : "fa-solid fa-bolt";

      if(s.image){
        detailImg.style.backgroundImage = `url('${s.image}')`;
        detailImg.style.display="block";
      }else{
        detailImg.style.backgroundImage = "";
        detailImg.style.display="none";
      }

      const tags = Array.isArray(s.tags) ? s.tags : [];
      detailTags.innerHTML = [
        `<span class="spec"><i class="fa-solid fa-tag"></i> ${escapeHtml(s.category||"")}</span>`,
        ...tags.slice(0,8).map(t=>`<span class="spec"><i class="fa-solid fa-circle-check"></i> ${escapeHtml(t)}</span>`)
      ].join("");

      detailProductArea.style.display = "none";
      detailServiceArea.style.display = "block";

      svcUrl.value = "";
      svcPay.value = "";
      svcTrx.value = "";
      svcNote.value = "";
      svcPrice.value = "0 Tk";

      if(s.unitType==="PACK"){
        svcPkgField.style.display = "block";
        svcQtyWrap.style.display = "none";
        svcPkg.innerHTML = `<option value="">Select package</option>` + (s.packages||[]).map((p,idx)=>(
          `<option value="${idx}">${escapeHtml(p.label)} — ${money(p.price)}</option>`
        )).join("");
      }else{
        svcPkgField.style.display = "none";
        svcQtyWrap.style.display = "flex";
        if(s.unitType==="K"){
          svcQtyLabel.textContent = "Quantity (K)";
          svcQty.innerHTML = `<option value="">Select quantity</option>` + (s.qtyList||[]).map(q=>(
            `<option value="${q}">${q}K</option>`
          )).join("");
        }else{
          svcQtyLabel.textContent = "Quantity (x100)";
          svcQty.innerHTML = `<option value="">Select quantity</option>` + (s.qtyList||[]).map(q=>(
            `<option value="${q}">${q*100}</option>`
          )).join("");
        }
      }

      detailOverlay.classList.add("show");
    }

    svcQty.addEventListener("change", ()=>{
      if(!currentDetail || currentDetail.mode!=="service") return;
      const s = services.find(x=>x.id===currentDetail.id);
      const v = svcQty.value ? Number(svcQty.value) : 0;
      if(!v){ svcPrice.value="0 Tk"; svcComputed={label:"",price:0}; return; }

      if(s.unitType==="K"){
        svcComputed.label = `${v}K`;
        svcComputed.price = v * Number(s.pricePerUnit||0);
      }else{
        svcComputed.label = `${v*100}`;
        svcComputed.price = v * Number(s.pricePerUnit||0);
      }
      svcPrice.value = money(svcComputed.price);
    });

    svcPkg.addEventListener("change", ()=>{
      if(!currentDetail || currentDetail.mode!=="service") return;
      const s = services.find(x=>x.id===currentDetail.id);
      const idx = svcPkg.value ? Number(svcPkg.value) : -1;
      if(idx<0){ svcPrice.value="0 Tk"; svcComputed={label:"",price:0}; return; }
      const p = (s.packages||[])[idx];
      svcComputed = { label: p.label, price: Number(p.price||0) };
      svcPrice.value = money(svcComputed.price);
    });

    svcSend.addEventListener("click", ()=>{
      if(!currentDetail || currentDetail.mode!=="service") return;
      const s = services.find(x=>x.id===currentDetail.id);
      if(!s) return;

      if(s.unitType==="PACK"){ if(!svcPkg.value) return alert("Package select করুন"); }
      else { if(!svcQty.value) return alert("Quantity select করুন"); }
      if(!svcUrl.value.trim()) return alert("Link/URL দিন");
      if(!svcPay.value) return alert("Payment method select করুন (bKash/Nagad)");
      if(!svcTrx.value.trim()) return alert("Transaction ID দিন");

      const msg =
`Assalamu Alaikum,
I want to place an order (Service).

Service: ${s.title}
Category: ${s.category}
Package/Qty: ${svcComputed.label}
Price: ${money(svcComputed.price)}

Payment:
Method: ${svcPay.value}
TrxID: ${svcTrx.value.trim()}

Link/URL:
${svcUrl.value.trim()}

Notes:
${svcNote.value.trim() || "N/A"}

Payment Numbers:
bKash: ${settings.payment?.bkash || ""}
Nagad: ${settings.payment?.nagad || ""}

-- ${settings.brandName}`;

      window.open(`${waBase()}?text=${encodeURIComponent(msg)}`, "_blank", "noopener,noreferrer");
    });

    prodBuy.addEventListener("click", ()=>{
      if(!currentDetail || currentDetail.mode!=="product") return;
      const p = products.find(x=>x.id===currentDetail.id);
      if(!p) return;

      const method = prodPay.value;
      const trx = prodTrx.value.trim();
      if(method!=="COD" && !trx) return alert("Online payment হলে TrxID দিন");
      const note = prodNote.value.trim();

      const msg =
`Assalamu Alaikum,
I want to place an order (Product).

Product: ${p.title}
SKU: ${p.sku || "N/A"}
Category: ${p.category || "N/A"}
Price: ${money(p.price)}
${p.regular ? `Regular: ${money(p.regular)}` : ""}

Payment:
Method: ${method}
TrxID: ${method==="COD" ? "N/A (COD)" : trx}

Customer Details:
${note || "N/A"}

Payment Numbers:
bKash: ${settings.payment?.bkash || ""}
Nagad: ${settings.payment?.nagad || ""}

-- ${settings.brandName}`;

      window.open(`${waBase()}?text=${encodeURIComponent(msg)}`, "_blank", "noopener,noreferrer");
    });

    /* click handlers for cards */
    document.addEventListener("click", (e)=>{
      const sOpen = e.target.closest("[data-open-service]");
      const sInfo = e.target.closest("[data-info-service]");
      const pOpen = e.target.closest("[data-open-product]");

      if(sOpen){
        const id = sOpen.getAttribute("data-open-service");
        const s = services.find(x=>x.id===id);
        if(s) openServiceDetail(s);
      }
      if(sInfo){
        const id = sInfo.getAttribute("data-info-service");
        const s = services.find(x=>x.id===id);
        if(!s) return;
        let details = `${s.title}\n\n${s.desc}\n\nCategory: ${s.category}\n`;
        if(s.unitType==="PACK"){
          details += "\nPackages:\n" + (s.packages||[]).map(p=>`- ${p.label}: ${money(p.price)} (${p.note||""})`).join("\n");
        }else{
          details += `\nPricing:\n- Rate: ${money(s.pricePerUnit)} per ${s.unitType==="K" ? "1K" : "100"}\n`;
        }
        alert(details);
      }
      if(pOpen){
        const id = pOpen.getAttribute("data-open-product");
        const p = products.find(x=>x.id===id);
        if(p) openProductDetail(p);
      }
    });

    /* -------- ADMIN APP (Shopify-like pages) -------- */
    const adminOverlay = document.getElementById("adminOverlay");
    const openAdmin = document.getElementById("openAdmin");
    const openAdmin2 = document.getElementById("openAdmin2");
    const closeAdmin = document.getElementById("closeAdmin");
    const adminCloseBtn = document.getElementById("adminCloseBtn");
    const adminCloseBtn2 = document.getElementById("adminCloseBtn2");

    const adminLoginView = document.getElementById("adminLoginView");
    const adminAppView = document.getElementById("adminAppView");
    const adminDashboard = document.getElementById("adminDashboard");
    const adminPage = document.getElementById("adminPage");
    const adminPath = document.getElementById("adminPath");
    const adminBack = document.getElementById("adminBack");

    const adminUser = document.getElementById("adminUser");
    const adminPass = document.getElementById("adminPass");
    const togglePass = document.getElementById("togglePass");
    const adminLoginBtn = document.getElementById("adminLoginBtn");
    const adminLogout = document.getElementById("adminLogout");
    const adminReset = document.getElementById("adminReset");

    let route = "dashboard"; // dashboard | branding | store | products | categories | services | payments | contact
    let editing = null;      // {kind:"product"/"service"/"category", id?}

    function showAdmin(){
      adminOverlay.classList.add("show");
      refreshAdminUI();
      setTimeout(()=> adminUser.focus(), 120);
    }
    function hideAdmin(){ adminOverlay.classList.remove("show"); }

    openAdmin.addEventListener("click", showAdmin);
    openAdmin2.addEventListener("click", showAdmin);
    closeAdmin.addEventListener("click", hideAdmin);
    adminCloseBtn.addEventListener("click", hideAdmin);
    adminCloseBtn2.addEventListener("click", hideAdmin);
    adminOverlay.addEventListener("click", (e)=>{ if(e.target===adminOverlay) hideAdmin(); });

    togglePass.addEventListener("click", ()=>{
      adminPass.type = (adminPass.type==="password") ? "text" : "password";
      togglePass.innerHTML = adminPass.type==="password" ? `<i class="fa-solid fa-eye"></i>` : `<i class="fa-solid fa-eye-slash"></i>`;
    });

    adminLoginBtn.addEventListener("click", ()=>{
      const u = adminUser.value.trim();
      const p = adminPass.value;
      if(u===ADMIN_USER && p===ADMIN_PASS){
        setAdminSession(true);
        toast("Login","Admin access granted ✅","success",1600);
        routeTo("dashboard");
        refreshAdminUI();
      }else{
        toast("Denied","Wrong username/password","error",2400);
      }
    });

    adminLogout.addEventListener("click", ()=>{
      setAdminSession(false);
      toast("Logout","Admin session ended","success",1500);
      routeTo("dashboard");
      refreshAdminUI();
    });

    adminReset.addEventListener("click", ()=>{
      if(!confirm("Reset করলে default data ফিরে যাবে. Continue?")) return;
      settings   = structuredClone(DEFAULT_SETTINGS);
      categories = structuredClone(DEFAULT_CATEGORIES);
      products   = structuredClone(DEFAULT_PRODUCTS);
      services   = structuredClone(DEFAULT_SERVICES);
      saveAll();
      toast("Reset","All restored to default ✅","success",2200);
      routeTo("dashboard");
      refreshAdminUI();
    });

    function routeTo(r){
      route = r;
      editing = null;
      renderAdmin();
    }

    adminBack.addEventListener("click", ()=> routeTo("dashboard"));

    document.getElementById("adminDashboard").addEventListener("click",(e)=>{
      const card = e.target.closest("[data-route]");
      if(!card) return;
      routeTo(card.getAttribute("data-route"));
    });

    function refreshAdminUI(){
      const authed = isAdmin();
      adminLoginView.style.display = authed ? "none" : "block";
      adminAppView.style.display   = authed ? "block" : "none";
      adminBack.style.display      = (authed && route!=="dashboard") ? "inline-flex" : "none";
      renderAdmin();
    }

    function renderAdmin(){
      if(!isAdmin()) return;

      adminDashboard.style.display = (route==="dashboard") ? "block" : "none";
      adminPage.style.display      = (route==="dashboard") ? "none" : "block";
      adminPath.textContent = route==="dashboard" ? "Dashboard" : `> ${route[0].toUpperCase()+route.slice(1)}`;
      adminBack.style.display = (route==="dashboard") ? "none" : "inline-flex";

      if(route==="branding") renderBrandingPage();
      if(route==="store") renderStorePage();
      if(route==="payments") renderPaymentsPage();
      if(route==="contact") renderContactPage();
      if(route==="categories") renderCategoriesPage();
      if(route==="products") renderProductsAdminPage();
      if(route==="services") renderServicesAdminPage();
    }

    /* Drag & drop uploader helper */
    function attachUploader(rootEl, stateObj, key, iconClass="fa-solid fa-image"){
      const up = rootEl.querySelector("[data-uploader]");
      const fileInput = rootEl.querySelector("[data-file]");
      const img = rootEl.querySelector("[data-img]");
      const icon = rootEl.querySelector("[data-icon]");
      const chooseBtn = rootEl.querySelector("[data-choose]");
      const removeBtn = rootEl.querySelector("[data-remove]");

      const paint = ()=>{
        const url = stateObj[key] || "";
        if(url){
          img.src = url; img.style.display="block";
          icon.style.display="none";
        }else{
          img.style.display="none";
          icon.style.display="block";
        }
      };
      paint();

      const setFile = async (file)=>{
        if(!file) return;
        try{
          stateObj[key] = await fileToDataUrl(file);
          paint();
          toast("Image","Uploaded ✅","success",1200);
        }catch{
          toast("Error","Image upload failed","error",2200);
        }
      };

      chooseBtn.addEventListener("click", ()=> fileInput.click());
      fileInput.addEventListener("change", ()=> setFile(fileInput.files?.[0]));
      removeBtn.addEventListener("click", ()=>{
        stateObj[key] = "";
        paint();
        toast("Removed","Image removed ✅","success",1200);
      });

      const prevent = (e)=>{ e.preventDefault(); e.stopPropagation(); };
      ["dragenter","dragover"].forEach(evt=> up.addEventListener(evt, (e)=>{ prevent(e); up.classList.add("drag"); }));
      ["dragleave","drop"].forEach(evt=> up.addEventListener(evt, (e)=>{ prevent(e); up.classList.remove("drag"); }));
      up.addEventListener("drop", (e)=>{
        const file = e.dataTransfer?.files?.[0];
        setFile(file);
      });
    }

    /* --- Branding page --- */
    function renderBrandingPage(){
      const local = { logoDataUrl: settings.logoDataUrl || "", coverDataUrl: settings.coverDataUrl || "" };

      adminPage.innerHTML = `
        <div class="box">
          <b><i class="fa-solid fa-image"></i> Branding (Logo + Cover)</b>
          <div class="muted bn" style="margin-top:6px;line-height:1.7">Logo/Cover আপলোড করলে customer page এ সাথে সাথে update হবে।</div>

          <div class="two" style="margin-top:12px">
            <div class="box">
              <b><i class="fa-solid fa-circle-user"></i> Logo</b>

              <div class="uploader" data-uploader style="margin-top:10px">
                <div style="display:flex;gap:12px;align-items:center">
                  <div class="previewBox">
                    <img data-img alt="logo preview">
                    <i data-icon class="fa-solid fa-circle-user"></i>
                  </div>
                  <div>
                    <div style="font-weight:900">Drag & Drop</div>
                    <div class="muted bn" style="font-size:12.5px;line-height:1.6">অথবা Choose Photo</div>
                  </div>
                </div>
                <div style="display:flex;gap:10px;flex-wrap:wrap">
                  <input data-file type="file" accept="image/*" style="display:none">
                  <button class="miniBtn ok" type="button" data-choose><i class="fa-solid fa-upload"></i> Choose</button>
                  <button class="miniBtn danger" type="button" data-remove><i class="fa-solid fa-trash"></i> Remove</button>
                </div>
              </div>

              <div class="muted bn" style="margin-top:10px;font-size:12.5px;line-height:1.6">
                Tip: Square logo দিলে সুন্দর দেখাবে।
              </div>
            </div>

            <div class="box">
              <b><i class="fa-solid fa-panorama"></i> Cover</b>

              <div class="uploader" data-uploader style="margin-top:10px">
                <div style="display:flex;gap:12px;align-items:center">
                  <div class="previewBox">
                    <img data-img alt="cover preview">
                    <i data-icon class="fa-solid fa-panorama"></i>
                  </div>
                  <div>
                    <div style="font-weight:900">Drag & Drop</div>
                    <div class="muted bn" style="font-size:12.5px;line-height:1.6">অথবা Choose Photo</div>
                  </div>
                </div>
                <div style="display:flex;gap:10px;flex-wrap:wrap">
                  <input data-file type="file" accept="image/*" style="display:none">
                  <button class="miniBtn ok" type="button" data-choose><i class="fa-solid fa-upload"></i> Choose</button>
                  <button class="miniBtn danger" type="button" data-remove><i class="fa-solid fa-trash"></i> Remove</button>
                </div>
              </div>

              <div class="muted bn" style="margin-top:10px;font-size:12.5px;line-height:1.6">
                Tip: Wide cover (landscape) দিলে best।
              </div>
            </div>
          </div>

          <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:12px">
            <button class="btn primary" id="saveBranding"><i class="fa-solid fa-floppy-disk"></i> Save</button>
            <button class="btn ghost" id="cancelBranding"><i class="fa-solid fa-xmark"></i> Cancel</button>
          </div>
        </div>
      `;

      const boxes = adminPage.querySelectorAll(".box .uploader");
      // first uploader is logo (local.logoDataUrl), second is cover (local.coverDataUrl)
      attachUploader(boxes[0].closest(".box"), local, "logoDataUrl", "fa-solid fa-circle-user");
      attachUploader(boxes[1].closest(".box"), local, "coverDataUrl", "fa-solid fa-panorama");

      document.getElementById("saveBranding").addEventListener("click", ()=>{
        settings.logoDataUrl = local.logoDataUrl;
        settings.coverDataUrl = local.coverDataUrl;
        saveAll();
        toast("Saved","Branding updated ✅","success",1600);
      });
      document.getElementById("cancelBranding").addEventListener("click", ()=> routeTo("dashboard"));
    }

    /* --- Store page --- */
    function renderStorePage(){
      adminPage.innerHTML = `
        <div class="box">
          <b><i class="fa-solid fa-store"></i> Store Info</b>

          <div class="field">
            <label>Brand Name</label>
            <input id="stBrand" value="${escapeHtml(settings.brandName||"")}" />
          </div>

          <div class="field">
            <label>Tagline</label>
            <input id="stTagline" value="${escapeHtml(settings.tagline||"")}" placeholder="Premium Digital Services..." />
          </div>

          <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:12px">
            <button class="btn primary" id="stSave"><i class="fa-solid fa-floppy-disk"></i> Save</button>
            <button class="btn ghost" id="stCancel"><i class="fa-solid fa-xmark"></i> Cancel</button>
          </div>
        </div>
      `;
      document.getElementById("stSave").addEventListener("click", ()=>{
        settings.brandName = document.getElementById("stBrand").value.trim() || DEFAULT_SETTINGS.brandName;
        settings.tagline = document.getElementById("stTagline").value.trim() || DEFAULT_SETTINGS.tagline;
        saveAll();
        toast("Saved","Store info updated ✅","success",1600);
      });
      document.getElementById("stCancel").addEventListener("click", ()=> routeTo("dashboard"));
    }

    /* --- Payments page --- */
    function renderPaymentsPage(){
      adminPage.innerHTML = `
        <div class="box">
          <b><i class="fa-solid fa-wallet"></i> Payments</b>

          <div class="field">
            <label>bKash Number</label>
            <input id="payBkash" value="${escapeHtml(settings.payment?.bkash||"")}" />
          </div>

          <div class="field">
            <label>Nagad Number</label>
            <input id="payNagad" value="${escapeHtml(settings.payment?.nagad||"")}" />
          </div>

          <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:12px">
            <button class="btn primary" id="paySave"><i class="fa-solid fa-floppy-disk"></i> Save</button>
            <button class="btn ghost" id="payCancel"><i class="fa-solid fa-xmark"></i> Cancel</button>
          </div>
        </div>
      `;
      document.getElementById("paySave").addEventListener("click", ()=>{
        settings.payment = settings.payment || {};
        settings.payment.bkash = document.getElementById("payBkash").value.trim();
        settings.payment.nagad = document.getElementById("payNagad").value.trim();
        saveAll();
        toast("Saved","Payment numbers updated ✅","success",1600);
      });
      document.getElementById("payCancel").addEventListener("click", ()=> routeTo("dashboard"));
    }

    /* --- Contact page --- */
    function renderContactPage(){
      adminPage.innerHTML = `
        <div class="box">
          <b><i class="fa-solid fa-address-card"></i> Contact / Address</b>

          <div class="field">
            <label>WhatsApp Number (wa.me) (example: 8801...)</label>
            <input id="cWa" value="${escapeHtml(settings.waNumber||"")}" />
          </div>

          <div class="field">
            <label>WhatsApp Display (example: 018...)</label>
            <input id="cWaRaw" value="${escapeHtml(settings.waRaw||"")}" />
          </div>

          <div class="field">
            <label>Email</label>
            <input id="cEmail" value="${escapeHtml(settings.email||"")}" />
          </div>

          <div class="field">
            <label>Facebook Page Link</label>
            <input id="cFb" value="${escapeHtml(settings.fb||"")}" />
          </div>

          <div class="field">
            <label>Address</label>
            <input id="cAddr" value="${escapeHtml(settings.address||"")}" />
          </div>

          <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:12px">
            <button class="btn primary" id="cSave"><i class="fa-solid fa-floppy-disk"></i> Save</button>
            <button class="btn ghost" id="cCancel"><i class="fa-solid fa-xmark"></i> Cancel</button>
          </div>
        </div>
      `;
      document.getElementById("cSave").addEventListener("click", ()=>{
        settings.waNumber = document.getElementById("cWa").value.trim() || DEFAULT_SETTINGS.waNumber;
        settings.waRaw = document.getElementById("cWaRaw").value.trim() || DEFAULT_SETTINGS.waRaw;
        settings.email = document.getElementById("cEmail").value.trim() || DEFAULT_SETTINGS.email;
        settings.fb = document.getElementById("cFb").value.trim() || DEFAULT_SETTINGS.fb;
        settings.address = document.getElementById("cAddr").value.trim() || DEFAULT_SETTINGS.address;
        saveAll();
        toast("Saved","Contact updated ✅","success",1600);
      });
      document.getElementById("cCancel").addEventListener("click", ()=> routeTo("dashboard"));
    }

    /* --- Categories page --- */
    function renderCategoriesPage(){
      const list = categories.filter(Boolean);

      adminPage.innerHTML = `
        <div class="box">
          <b><i class="fa-solid fa-tags"></i> Categories</b>
          <div class="muted bn" style="margin-top:6px;line-height:1.7">Product add/edit করার সময় এই categories dropdown এ দেখাবে।</div>

          <div class="two" style="margin-top:12px">
            <div class="box">
              <b><i class="fa-solid fa-plus"></i> Add New Category</b>
              <div class="field">
                <label>Category Name</label>
                <input id="catNew" placeholder="e.g. Electronics" />
              </div>
              <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:12px">
                <button class="btn primary" id="catAdd"><i class="fa-solid fa-plus"></i> Add</button>
              </div>
            </div>

            <div class="box">
              <b><i class="fa-solid fa-list"></i> Current</b>
              <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:10px" id="catChips">
                ${list.map(c=>`<span class="chip" style="gap:10px">${escapeHtml(c)} <button class="miniBtn danger" data-del="${escapeHtml(c)}" type="button"><i class="fa-solid fa-trash"></i></button></span>`).join("") || `<span class="muted">No categories</span>`}
              </div>
              <div class="muted bn" style="margin-top:10px;font-size:12.5px;line-height:1.6">
                Delete করলে ওই category এর product গুলোতে category খালি হয়ে যেতে পারে—পরে edit করে ঠিক করুন।
              </div>
            </div>
          </div>

          <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:12px">
            <button class="btn ghost" id="catBack"><i class="fa-solid fa-arrow-left"></i> Back</button>
          </div>
        </div>
      `;

      document.getElementById("catAdd").addEventListener("click", ()=>{
        const v = document.getElementById("catNew").value.trim();
        if(!v) return toast("Missing","Category name required","error",2200);
        if(categories.some(x=>String(x).toLowerCase()===v.toLowerCase())) return toast("Exists","Already in list","error",2200);
        categories.push(v);
        saveAll();
        toast("Added","Category added ✅","success",1400);
        renderCategoriesPage();
      });

      document.getElementById("catChips").addEventListener("click",(e)=>{
        const b = e.target.closest("[data-del]");
        if(!b) return;
        const name = b.getAttribute("data-del");
        if(!confirm(`Delete category "${name}"?`)) return;
        categories = categories.filter(x=>x!==name);
        // keep products safe: if they had that category, set to empty
        products = products.map(p => (p.category===name ? {...p, category:""} : p));
        saveAll();
        toast("Deleted","Category removed ✅","success",1400);
        renderCategoriesPage();
      });

      document.getElementById("catBack").addEventListener("click", ()=> routeTo("dashboard"));
    }

    /* --- Products admin page --- */
    function renderProductsAdminPage(){
      const q = "";
      adminPage.innerHTML = `
        <div class="box">
          <div style="display:flex;gap:10px;flex-wrap:wrap;justify-content:space-between;align-items:center">
            <b><i class="fa-solid fa-bag-shopping"></i> Products</b>
            <button class="btn pink" id="pAddNew"><i class="fa-solid fa-plus"></i> Add New</button>
          </div>

          <div class="tableWrap">
            <table>
              <thead>
                <tr>
                  <th style="width:110px">Image</th>
                  <th>Product</th>
                  <th style="width:140px">SKU</th>
                  <th style="width:160px">Category</th>
                  <th style="width:130px">Price</th>
                  <th style="width:220px">Actions</th>
                </tr>
              </thead>
              <tbody id="pTbody"></tbody>
            </table>
          </div>

          <div id="pFormArea" style="margin-top:12px"></div>
        </div>
      `;

      const tbody = document.getElementById("pTbody");
      tbody.innerHTML = products.map(p=>{
        const img = p.image ? "Yes" : "No";
        return `
          <tr>
            <td><span class="chip"><i class="fa-solid fa-image"></i> ${img}</span></td>
            <td>
              <div style="font-weight:900;color:var(--text)">${escapeHtml(p.title)}</div>
              <div style="margin-top:4px;max-width:420px">${escapeHtml((p.desc||"").slice(0,90))}${(p.desc||"").length>90?"…":""}</div>
            </td>
            <td>${escapeHtml(p.sku||"")}</td>
            <td>${escapeHtml(p.category||"")}</td>
            <td>${money(p.price)}</td>
            <td>
              <div class="tActions">
                <button class="miniBtn ok" data-edit="${escapeHtml(p.id)}"><i class="fa-solid fa-pen"></i> Edit</button>
                <button class="miniBtn warn" data-copy="${escapeHtml(p.id)}"><i class="fa-solid fa-copy"></i> Duplicate</button>
                <button class="miniBtn danger" data-del="${escapeHtml(p.id)}"><i class="fa-solid fa-trash"></i> Delete</button>
              </div>
            </td>
          </tr>
        `;
      }).join("");

      const formArea = document.getElementById("pFormArea");

      const openForm = (p)=>{
        const local = structuredClone(p || { id: makeId("p"), title:"", sku:"", desc:"", category:(categories[0]||""), price:0, regular:null, image:"", tags:[] });

        formArea.innerHTML = `
          <div class="box">
            <b><i class="fa-solid fa-pen"></i> ${p ? "Edit Product" : "Add New Product"}</b>
            <div class="muted" style="margin-top:6px;font-size:12.5px">ID: <span class="chip">${escapeHtml(local.id)}</span></div>

            <div class="two" style="margin-top:12px">
              <div class="box">
                <b><i class="fa-solid fa-image"></i> Product Image</b>

                <div class="uploader" data-uploader style="margin-top:10px">
                  <div style="display:flex;gap:12px;align-items:center">
                    <div class="previewBox">
                      <img data-img alt="product preview">
                      <i data-icon class="fa-solid fa-box"></i>
                    </div>
                    <div>
                      <div style="font-weight:900">Drag & Drop</div>
                      <div class="muted bn" style="font-size:12.5px;line-height:1.6">অথবা Choose Photo</div>
                    </div>
                  </div>
                  <div style="display:flex;gap:10px;flex-wrap:wrap">
                    <input data-file type="file" accept="image/*" style="display:none">
                    <button class="miniBtn ok" type="button" data-choose><i class="fa-solid fa-upload"></i> Choose</button>
                    <button class="miniBtn danger" type="button" data-remove><i class="fa-solid fa-trash"></i> Remove</button>
                  </div>
                </div>

                <div class="field">
                  <label>Price (Tk)</label>
                  <input id="pfPrice" type="number" value="${Number(local.price||0)}" />
                </div>

                <div class="field">
                  <label>Regular Price (optional)</label>
                  <input id="pfReg" type="number" value="${local.regular==null ? "" : Number(local.regular)}" placeholder="optional" />
                </div>
              </div>

              <div class="box">
                <div class="field">
                  <label>Product Name</label>
                  <input id="pfTitle" value="${escapeHtml(local.title)}" />
                </div>

                <div class="field">
                  <label>SKU</label>
                  <input id="pfSku" value="${escapeHtml(local.sku||"")}" placeholder="e.g. GAD-001" />
                </div>

                <div class="field">
                  <label>Category</label>
                  <select id="pfCat">
                    ${["", ...categories].filter((v,i,a)=>a.indexOf(v)===i).map(c=>(
                      `<option value="${escapeHtml(c)}" ${c===local.category?"selected":""}>${escapeHtml(c||"Select")}</option>`
                    )).join("")}
                  </select>
                </div>

                <div class="field">
                  <label>Description</label>
                  <textarea id="pfDesc">${escapeHtml(local.desc||"")}</textarea>
                </div>

                <div class="field">
                  <label>Tags (comma separated)</label>
                  <input id="pfTags" value="${escapeHtml((local.tags||[]).join(", "))}" placeholder="Hot, Deal, New" />
                </div>

                <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:12px">
                  <button class="btn primary" id="pfSave"><i class="fa-solid fa-floppy-disk"></i> Save</button>
                  <button class="btn ghost" id="pfCancel"><i class="fa-solid fa-xmark"></i> Cancel</button>
                </div>
              </div>
            </div>
          </div>
        `;

        // attach uploader for product
        local.image = local.image || "";
        attachUploader(formArea.querySelector(".box .box"), local, "image", "fa-solid fa-box");

        formArea.querySelector("#pfSave").addEventListener("click", ()=>{
          const title = formArea.querySelector("#pfTitle").value.trim();
          if(!title) return toast("Missing","Product name required","error",2200);

          local.title = title;
          local.sku = formArea.querySelector("#pfSku").value.trim();
          local.category = formArea.querySelector("#pfCat").value.trim();
          local.desc = formArea.querySelector("#pfDesc").value.trim();
          local.price = Number(formArea.querySelector("#pfPrice").value || 0);
          const r = formArea.querySelector("#pfReg").value.trim();
          local.regular = r==="" ? null : Number(r);
          local.tags = formArea.querySelector("#pfTags").value.split(",").map(x=>x.trim()).filter(Boolean);

          const exists = products.some(x=>x.id===local.id);
          products = exists ? products.map(x=>x.id===local.id ? local : x) : [local, ...products];

          saveAll();
          toast("Saved","Product updated ✅","success",1600);
          renderProductsAdminPage();
        });

        formArea.querySelector("#pfCancel").addEventListener("click", ()=>{ formArea.innerHTML=""; });
      };

      document.getElementById("pAddNew").addEventListener("click", ()=> openForm(null));

      tbody.addEventListener("click",(e)=>{
        const ed = e.target.closest("[data-edit]");
        const cp = e.target.closest("[data-copy]");
        const dl = e.target.closest("[data-del]");
        if(ed){
          const id = ed.getAttribute("data-edit");
          const p = products.find(x=>x.id===id);
          if(p) openForm(p);
        }
        if(cp){
          const id = cp.getAttribute("data-copy");
          const p = products.find(x=>x.id===id);
          if(!p) return;
          const cloned = structuredClone(p);
          cloned.id = makeId("p");
          cloned.title = `${cloned.title} (Copy)`;
          products = [cloned, ...products];
          saveAll();
          toast("Duplicated","Product copied ✅","success",1400);
          renderProductsAdminPage();
        }
        if(dl){
          const id = dl.getAttribute("data-del");
          if(!confirm("Delete this product?")) return;
          products = products.filter(x=>x.id!==id);
          saveAll();
          toast("Deleted","Product removed ✅","success",1400);
          renderProductsAdminPage();
        }
      });
    }

    /* --- Services admin page --- */
    function renderServicesAdminPage(){
      adminPage.innerHTML = `
        <div class="box">
          <div style="display:flex;gap:10px;flex-wrap:wrap;justify-content:space-between;align-items:center">
            <b><i class="fa-solid fa-bolt"></i> Social Media Services</b>
            <button class="btn pink" id="sAddNew"><i class="fa-solid fa-plus"></i> Add New</button>
          </div>

          <div class="tableWrap">
            <table>
              <thead>
                <tr>
                  <th style="width:110px">Image</th>
                  <th>Service</th>
                  <th style="width:170px">Category</th>
                  <th style="width:160px">Pricing</th>
                  <th style="width:220px">Actions</th>
                </tr>
              </thead>
              <tbody id="sTbody"></tbody>
            </table>
          </div>

          <div id="sFormArea" style="margin-top:12px"></div>
        </div>
      `;

      const tbody = document.getElementById("sTbody");
      tbody.innerHTML = services.map(s=>{
        const img = s.image ? "Yes" : "No";
        const pricing = s.unitType==="PACK" ? "PACK" : `${money(s.pricePerUnit)} / ${s.unitType==="K"?"1K":"100"}`;
        return `
          <tr>
            <td><span class="chip"><i class="fa-solid fa-image"></i> ${img}</span></td>
            <td>
              <div style="font-weight:900;color:var(--text)">${escapeHtml(s.title)}</div>
              <div style="margin-top:4px;max-width:420px">${escapeHtml((s.desc||"").slice(0,90))}${(s.desc||"").length>90?"…":""}</div>
            </td>
            <td>${escapeHtml(s.category||"")}</td>
            <td>${escapeHtml(pricing)}</td>
            <td>
              <div class="tActions">
                <button class="miniBtn ok" data-edit="${escapeHtml(s.id)}"><i class="fa-solid fa-pen"></i> Edit</button>
                <button class="miniBtn warn" data-copy="${escapeHtml(s.id)}"><i class="fa-solid fa-copy"></i> Duplicate</button>
                <button class="miniBtn danger" data-del="${escapeHtml(s.id)}"><i class="fa-solid fa-trash"></i> Delete</button>
              </div>
            </td>
          </tr>
        `;
      }).join("");

      const formArea = document.getElementById("sFormArea");

      const openForm = (s)=>{
        const local = structuredClone(s || {
          id: makeId("s"),
          category:"Facebook",
          icon:"fa-solid fa-bolt",
          title:"",
          desc:"",
          unitType:"K",
          pricePerUnit:0,
          qtyList:[1,2,3,5,10],
          packages:[],
          tags:[],
          image:""
        });

        formArea.innerHTML = `
          <div class="box">
            <b><i class="fa-solid fa-pen"></i> ${s ? "Edit Service" : "Add New Service"}</b>
            <div class="muted" style="margin-top:6px;font-size:12.5px">ID: <span class="chip">${escapeHtml(local.id)}</span></div>

            <div class="two" style="margin-top:12px">
              <div class="box">
                <b><i class="fa-solid fa-image"></i> Service Image</b>

                <div class="uploader" data-uploader style="margin-top:10px">
                  <div style="display:flex;gap:12px;align-items:center">
                    <div class="previewBox">
                      <img data-img alt="service preview">
                      <i data-icon class="fa-solid fa-bolt"></i>
                    </div>
                    <div>
                      <div style="font-weight:900">Drag & Drop</div>
                      <div class="muted bn" style="font-size:12.5px;line-height:1.6">অথবা Choose Photo</div>
                    </div>
                  </div>
                  <div style="display:flex;gap:10px;flex-wrap:wrap">
                    <input data-file type="file" accept="image/*" style="display:none">
                    <button class="miniBtn ok" type="button" data-choose><i class="fa-solid fa-upload"></i> Choose</button>
                    <button class="miniBtn danger" type="button" data-remove><i class="fa-solid fa-trash"></i> Remove</button>
                  </div>
                </div>

                <div class="field">
                  <label>Category (Facebook/YouTube/Instagram/...)</label>
                  <input id="sfCat" value="${escapeHtml(local.category||"")}" />
                </div>

                <div class="field">
                  <label>Icon class (optional)</label>
                  <input id="sfIcon" value="${escapeHtml(local.icon||"")}" placeholder="fa-brands fa-facebook" />
                </div>

                <div class="field">
                  <label>Unit Type</label>
                  <select id="sfUnit">
                    <option value="K" ${local.unitType==="K"?"selected":""}>K (1K,2K)</option>
                    <option value="100" ${local.unitType==="100"?"selected":""}>x100 (100,200)</option>
                    <option value="PACK" ${local.unitType==="PACK"?"selected":""}>PACK (packages)</option>
                  </select>
                </div>
              </div>

              <div class="box">
                <div class="field">
                  <label>Service Name</label>
                  <input id="sfTitle" value="${escapeHtml(local.title||"")}" />
                </div>

                <div class="field">
                  <label>Description</label>
                  <textarea id="sfDesc">${escapeHtml(local.desc||"")}</textarea>
                </div>

                <div class="field">
                  <label>Tags (comma separated)</label>
                  <input id="sfTags" value="${escapeHtml((local.tags||[]).join(", "))}" />
                </div>

                <div id="rateBox" style="display:${local.unitType==="PACK"?"none":"block"}">
                  <div class="field">
                    <label>Price Per Unit (Tk)</label>
                    <input id="sfRate" type="number" value="${Number(local.pricePerUnit||0)}" />
                  </div>
                  <div class="field">
                    <label>Qty List (comma separated numbers)</label>
                    <input id="sfQty" value="${escapeHtml((local.qtyList||[]).join(","))}" placeholder="1,2,3,5,10" />
                  </div>
                </div>

                <div id="packBox" style="display:${local.unitType==="PACK"?"block":"none"}">
                  <div class="field">
                    <label>Packages JSON</label>
                    <textarea id="sfPack" style="min-height:150px" spellcheck="false">${escapeHtml(JSON.stringify(local.packages||[], null, 2))}</textarea>
                  </div>
                  <div class="muted" style="font-size:12.5px;line-height:1.6">
                    Format: [{"label":"Basic","price":300,"note":"..."}]
                  </div>
                </div>

                <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:12px">
                  <button class="btn primary" id="sfSave"><i class="fa-solid fa-floppy-disk"></i> Save</button>
                  <button class="btn ghost" id="sfCancel"><i class="fa-solid fa-xmark"></i> Cancel</button>
                </div>
              </div>
            </div>
          </div>
        `;

        attachUploader(formArea.querySelector(".box .box"), local, "image", "fa-solid fa-bolt");

        const unitEl = formArea.querySelector("#sfUnit");
        const rateBox = formArea.querySelector("#rateBox");
        const packBox = formArea.querySelector("#packBox");

        unitEl.addEventListener("change", ()=>{
          local.unitType = unitEl.value;
          rateBox.style.display = (local.unitType==="PACK") ? "none" : "block";
          packBox.style.display = (local.unitType==="PACK") ? "block" : "none";
        });

        formArea.querySelector("#sfSave").addEventListener("click", ()=>{
          const title = formArea.querySelector("#sfTitle").value.trim();
          const cat   = formArea.querySelector("#sfCat").value.trim();
          if(!title) return toast("Missing","Service name required","error",2200);
          if(!cat) return toast("Missing","Category required","error",2200);

          local.title = title;
          local.category = cat;
          local.icon = formArea.querySelector("#sfIcon").value.trim() || "fa-solid fa-bolt";
          local.desc = formArea.querySelector("#sfDesc").value.trim();
          local.tags = formArea.querySelector("#sfTags").value.split(",").map(x=>x.trim()).filter(Boolean);

          local.unitType = formArea.querySelector("#sfUnit").value;

          if(local.unitType==="PACK"){
            try{
              const parsed = JSON.parse(formArea.querySelector("#sfPack").value || "[]");
              if(!Array.isArray(parsed)) throw new Error("Packages must be an array");
              local.packages = parsed.map(p=>({
                label: String(p.label||"Package"),
                price: Number(p.price||0),
                note: String(p.note||"")
              }));
              local.pricePerUnit = 0;
              local.qtyList = [];
            }catch(err){
              toast("Invalid","Packages JSON error: " + (err?.message||"Invalid"),"error",3800);
              return;
            }
          }else{
            local.pricePerUnit = Number(formArea.querySelector("#sfRate").value || 0);
            local.qtyList = (formArea.querySelector("#sfQty").value||"").split(",")
              .map(x=>Number(String(x).trim()))
              .filter(n=>Number.isFinite(n) && n>0);
            local.packages = [];
            if(local.qtyList.length===0) return toast("Missing","Qty list required (e.g. 1,2,3,5)","error",2600);
          }

          const exists = services.some(x=>x.id===local.id);
          services = exists ? services.map(x=>x.id===local.id ? local : x) : [local, ...services];

          saveAll();
          toast("Saved","Service updated ✅","success",1600);
          renderServicesAdminPage();
        });

        formArea.querySelector("#sfCancel").addEventListener("click", ()=>{ formArea.innerHTML=""; });
      };

      document.getElementById("sAddNew").addEventListener("click", ()=> openForm(null));

      tbody.addEventListener("click",(e)=>{
        const ed = e.target.closest("[data-edit]");
        const cp = e.target.closest("[data-copy]");
        const dl = e.target.closest("[data-del]");
        if(ed){
          const id = ed.getAttribute("data-edit");
          const s = services.find(x=>x.id===id);
          if(s) openForm(s);
        }
        if(cp){
          const id = cp.getAttribute("data-copy");
          const s = services.find(x=>x.id===id);
          if(!s) return;
          const cloned = structuredClone(s);
          cloned.id = makeId("s");
          cloned.title = `${cloned.title} (Copy)`;
          services = [cloned, ...services];
          saveAll();
          toast("Duplicated","Service copied ✅","success",1400);
          renderServicesAdminPage();
        }
        if(dl){
          const id = dl.getAttribute("data-del");
          if(!confirm("Delete this service?")) return;
          services = services.filter(x=>x.id!==id);
          saveAll();
          toast("Deleted","Service removed ✅","success",1400);
          renderServicesAdminPage();
        }
      });
    }

    /* -------- init render -------- */
    function rebuildAll(){
      applyStoreUI();
      rebuildProductCategoryFilter();
      rebuildServiceCategoryChips();
      renderServices();
      renderProducts();
      toast("Ready","Customer + Admin (Shopify-like) ✅","success",2200);
    }

    // admin open/close
    document.getElementById("adminCloseBtn").addEventListener("click", hideAdmin);
    document.getElementById("adminCloseBtn2").addEventListener("click", hideAdmin);

    // ESC close
    document.addEventListener("keydown",(e)=>{
      if(e.key==="Escape"){
        detailOverlay.classList.remove("show");
        adminOverlay.classList.remove("show");
      }
    });

    // start
    rebuildAll();
  </script>
</body>
</html>